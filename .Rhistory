# ** based upon durmon
currpreg_dates
currpreg_dates %>%
summary()
currpreg_dates
summary(raw_pheno)
# Load raw pheno
raw_pheno <- read_csv(file = here::here("Data/Phenotypic_Data/full_nsf_w_covariates.csv")) %>%
clean_names()
raw_pheno
raw_pheno %>%
summary()
raw_pheno %>% select(contains("lmp"))
currpreg_dates %>%
summary()
dim(currpreg_dates)
raw_pheno
currpreg_dates %>%
# Left join pregnancy dates to raw pheno
raw_pheno <-left_join(raw_pheno,
currpreg_dates,
by = c("uncchdid", "nsfnumb"))
# Left join pregnancy dates to raw pheno
raw_pheno <-left_join(raw_pheno,
currpreg_dates,
by = c("uncchdid", "nsfnumb"))
raw_pheno
raw_pheno %>%
summary()
raw_pheno <- read_csv(file = here::here("Data/Phenotypic_Data/full_nsf_w_covariates.csv")) %>%
clean_names()
# Check for missing lmp or dur
raw_pheno %>% select(contains("lmp"))
# Not present.
# Load pregnancy data for dates and ids
currpreg_dates <- read_dta("Data/Phenotypic_Data/final NSF IC Female Pregnancy Tracking files/Pregnancy files/corrected Stata files/currpreg20141016.dta") %>%
select(uncchdid, nsfnumb, pregord, lmpdate, durmonth)
# Check for missing lmp or dur
dim(currpreg_dates)
currpreg_dates %>%
summary()
# Only missing 4 for lmp date...
# Left join pregnancy dates to raw pheno
raw_pheno_new <-left_join(raw_pheno,
currpreg_dates,
by = c("uncchdid", "nsfnumb", "pregord_all" = "pregord"))
raw_pheno_new %>%
summary()
# Join but remove pregord_all = pregord requirement (i.e. assume that my calculation of pregord all is right or pregord is, but not both)
raw_pheno <-left_join(raw_pheno,
currpreg_dates,
by = c("uncchdid", "nsfnumb"))
summary(raw_pheno)
# Now quickly check pregord_all/pregord
raw_pheno %>%
ggplot(., aes(pregord_all, pregord))+
geom_point()
ggplot(., aes(pregord_type, number))+
geom_point()
# Now quickly check pregord_all/pregord
raw_pheno %>%
gather(., key = pregord_type, value = number, c(pregord,pregord_all))
# Now quickly check pregord_all/pregord
raw_pheno %>%
gather(., key = pregord_type, value = number, c(pregord,pregord_all)) %>%
ggplot(., aes(pregord_type, number))+
geom_point()
# Now quickly check pregord_all/pregord
raw_pheno %>%
gather(., key = pregord_type, value = number, c(pregord,pregord_all)) %>%
ggplot(., aes(pregord_type, number, group = uncchdid))+
geom_point()+
geom_line()
# Now quickly check pregord_all/pregord
raw_pheno %>%
gather(., key = pregord_type, value = number, c(pregord,pregord_all)) %>%
ggplot(., aes(pregord_type, number, group = uncchdid))+
geom_point(alpha = 0.2)+
geom_line(alpha = 0.2)
# Now quickly check pregord_all/pregord
raw_pheno %>%
filter(pregord_all != pregord) %>%
gather(., key = pregord_type, value = number, c(pregord,pregord_all)) %>%
ggplot(., aes(pregord_type, number, group = uncchdid))+
geom_point(alpha = 0.2)+
geom_line(alpha = 0.2)
# Now quickly check pregord_all/pregord
raw_pheno %>%
filter(pregord_all != pregord) %>%
gather(., key = pregord_type, value = number, c(pregord,pregord_all)) %>%
ggplot(., aes(pregord_type, number, group = uncchdid))+
geom_point(alpha = 0.2)+
geom_line(alpha = 0.1)
# Create ga_file
###############
ga_file <-raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
select(uncchdid, lmpdate, date_preg_term, gestage, durmonth, outcome, date_preg_anthro)
# Look at GA distributions
###############
ga_file %>%
ggplot(., aes(x = gestage))+
geom_histogram()
# Who is it?
ga_file %>%
filter(gestage <0)
# Fix the year of lmp for 23228
ga_file[ga_file$uncchdid == "23228", "lmpdate"] <-as_date("2010-02-15")
# Recalculate gestage
ga_file <-ga_file %>%
mutate(gestage = date_preg_term - lmpdate)
# Check
ga_file %>%
ggplot(., aes(x = gestage))+
geom_histogram()
# good.
#
range(ga_file$gestage, na.rm = TRUE)
month(sjlabelled::as_numeric(ga_file$durmonth), label = FALSE)
ga_file$gestage_days <-
sjlabelled::remove_all_labels(ga_file$gestage)
ga_file %>%
ggplot(., aes(x = gestage_days, y = gestage))+
geom_point()
ga_file %>%
ggplot(., aes(x = gestage_days, y = durmonth))+
geom_point()
ga_file %>%
ggplot(., aes(x = durmonth, y = gestage_days))+
geom_point()
ga_file %>%
ggplot(., aes(x = durmonth, y = gestage_days))+
geom_point()+
geom_boxplot()
ga_file %>%
ggplot(., aes(x = durmonth, y = gestage_days, groups = durmonth))+
geom_point()+
geom_boxplot()
ga_file %>%
ggplot(., aes(x = durmonth, y = gestage_days, group = durmonth))+
geom_point()+
geom_boxplot()
ga_file %>%
ggplot(., aes(x = durmonth, y = gestage_days, group = durmonth))+
geom_boxplot(alpha = 0.2)+
geom_point()
ga_file %>%
ggplot(., aes(x = durmonth, y = gestage_days, group = durmonth))+
geom_boxplot(alpha = 0.2)+
geom_jitter()
ga_file %>%
ggplot(., aes(x = durmonth, y = gestage_days, group = durmonth))+
geom_boxplot(alpha = 0.2)+
geom_jitter(0.1, alpha = 0.2)
ga_file %>%
ggplot(., aes(x = durmonth, y = gestage_days, group = durmonth))+
geom_boxplot(alpha = 0.2)+
geom_jitter(position = 0.1, alpha = 0.2)
ga_file %>%
ggplot(., aes(x = durmonth, y = gestage_days, group = durmonth))+
geom_boxplot(alpha = 0.2)+
geom_jitter(position = 1, alpha = 0.2)
ga_file %>%
ggplot(., aes(x = durmonth, y = gestage_days, group = durmonth))+
geom_boxplot(alpha = 0.2)+
geom_jitter(width = 0.1, alpha = 0.2)
# Early births
###############
ga_file %>%
filter(gestage < 269)
# Late Births
#############
ga_file %>%
filter(gestage > 308)
# Look at GA distributions
###############
ga_file %>%
ggplot(., aes(x = gestage))+
geom_histogram()
summary(ga_file$gestage)
mean(ga_file$gestage)
mean(ga_file$gestage, na.rm = T)
# Check
ga_file %>%
ggplot(., aes(x = gestage))+
geom_histogram()
# Check
ga_file %>%
ggplot(., aes(x = gestage))+
geom_histogram()+
geom_vline(xintercept = c(269, 308)) # based on the paper cited below
# good.
#
range(ga_file$gestage, na.rm = TRUE)
# What if I filter to only those with consistent pregord = pregord_all
ga_file %>%
filter(pregord_all == pregord) %>%
ggplot(., aes(x = gestage))+
geom_histogram()+
geom_vline(xintercept = c(269, 308))
ga_file %>%
filter(pregord_all == pregord)
# What if I filter to only those with consistent pregord = pregord_all
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(pregord_all == pregord) %>%
ggplot(., aes(x = gestage))+
geom_histogram()+
geom_vline(xintercept = c(269, 308))
# What if I filter to only those with consistent pregord = pregord_all
raw_pheno[raw_pheno$uncchdid == "23228", "lmpdate"] <-as_date("2010-02-15")
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(pregord_all == pregord) %>%
ggplot(., aes(x = gestage))+
geom_histogram()+
geom_vline(xintercept = c(269, 308))
# Check
ga_file %>%
ggplot(., aes(x = gestage))+
geom_histogram()+
geom_vline(xintercept = c(269, 308)) # based on the paper cited below
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(pregord_all == pregord) %>%
ggplot(., aes(x = gestage))+
geom_histogram()+
geom_vline(xintercept = c(269, 308))
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(pregord_all == pregord)
ga_file
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate)
raw_pheno$sample_type
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(pregord_all == pregord,
sample_type == "pregnancy") %>%
ggplot(., aes(x = gestage))+
geom_histogram()+
geom_vline(xintercept = c(269, 308))
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(pregord_all == pregord,
sample_type == "pregnancy")
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(sample_type == "pregnancy"))
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(sample_type == "pregnancy")
# Check using only pregnancy samples
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(sample_type == "pregnancy") %>%
nrow()
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(sample_type == "pregnancy") %>%
group_by(uncchdid) %>%
filter(n() > 1)
raw_pheno_w_ga <-raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(sample_type == "pregnancy")
raw_pheno_w_ga %>%
ggplot(., aes(x = bmi, y = gestage)) %>%
geom_point()
raw_pheno_w_ga %>%
ggplot(., aes(x = bmi, y = gestage)) +
geom_point()
raw_pheno_w_ga %>%
ggplot(., aes(x = numbpreg, y = gestage)) +
geom_point()
raw_pheno_w_ga %>%
ggplot(., aes(x = gestage, y = icc_weight_birth)) +
geom_point()
raw_pheno_w_ga %>%
ggplot(., aes(x = gestage, y = icc_weight_birth)) +
geom_point(alpha = 0.2)
raw_pheno_w_ga %>%
ggplot(., aes(x = gestage, y = icc_weight_birth, col = iccsex)) +
geom_point(alpha = 0.2)
raw_pheno_w_ga %>%
ggplot(., aes(x = gestage, y = icc_weight_birth, col = iccsex)) +
geom_point(alpha = 0.5)
raw_pheno_w_ga %>%
ggplot(., aes(x = gestage, y = icc_weight_birth, col = iccsex)) +
geom_point(alpha = 0.8)
raw_pheno_w_ga %>%
ggplot(., aes(x = gestage, y = icc_weight_birth, col = iccsex)) +
geom_point(alpha = 0.8)+
theme_bw
raw_pheno_w_ga %>%
ggplot(., aes(x = gestage, y = icc_weight_birth, col = iccsex)) +
geom_point(alpha = 0.8)+
theme_bw()
raw_pheno_w_ga %>%
select(date_icc_meas, date_prg_term)
raw_pheno_w_ga %>%
mutate(date_icc_meas-date_prg_term)
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home)) +
geom_point()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 14) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home)) +
geom_point()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home)) +
geom_point()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
facet_grid(~iccsex)
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 1)
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 1)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 5)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 2)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 3)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 6)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 4)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 7)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 8)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 9)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "div", palette = "spectrum")+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "div", palette = 1)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "div", palette = 5)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "seq", palette = 5)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "seq", palette = 2)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 2)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 3)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 4)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 5)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point()+
scale_color_brewer(type = "qual", palette = 5)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point()+
scale_color_brewer(type = "qual", palette = 1)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(size = 3)+
scale_color_brewer(type = "qual", palette = 1)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_weight_home, col = iccsex)) +
geom_point(size = 3)+
scale_color_brewer(type = "qual", palette = 1)+
facet_grid(~iccsex)+
theme_bw()
write_csv(raw_pheno_w_ga, here::here("Output/Data/Phenotypic_Data", "raw_pheno_w_ga.csv")
)
write_csv(raw_pheno_w_ga, here::here("Output/Data", "raw_pheno_w_ga.csv")
)

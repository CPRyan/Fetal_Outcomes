# Loading packages
library(tidyverse)
library(lubridate)
library(janitor)
library(skimr)
library(corrplot)
library(haven)
library(ggpubr)
library(sjlabelled)
library(sjPlot)
# Read in datasets
raw_pheno_gest <- read_csv(file = here::here("Output/Data/raw_pheno_w_ga.csv")) %>%
clean_names() %>%
select(-iccsex) %>%
mutate(uncchdid = as_character(uncchdid)) %>%
rename(blood_spot_date = date)
icc_sex_data <- read_csv(file = here::here("Data/Phenotypic_Data/full_nsf_w_covariates.csv")) %>%
clean_names() %>%
filter(sample_type == "pregnancy") %>%
select(uncchdid, iccsex, nsfnumb) %>%
mutate(uncchdid = as_character(uncchdid))  # don't use double here
BMI_values <- read_dta(file = here::here("Data/Phenotypic_Data/For Ravi - pre BMI.dta")) %>%
clean_names() %>%
select(uncchdid, prebmiz) %>%
mutate(uncchdid = as_character(uncchdid)) %>%
na.omit() %>%  # And remove the NAs, because they always have at least one pre-preg BMI and one NA
unique() # Here I can remove duplicates, as they're redundant and the same for all pregnancies.
clock_data <- read_csv(file = here::here("Data/Clock_Data/cebu_long_w_baddetP_kept_in.output.csv")) %>%
clean_names() %>%
filter(str_detect(sample_id, "_p")) %>%
mutate(uncchdid = str_sub(sample_id, 2, 6)) %>% # because a few samples have _rep4 at the end, we need 2nd to 6th character, no 2nd to length -1
mutate(uncchdid = as_character(uncchdid))
full_ses_anthro <- read_csv(file = here::here("Data/Phenotypic_Data/full_ses_anthro.csv")) %>%
clean_names() %>%
arrange(uncchdid) %>%
mutate(uncchdid = as_character(uncchdid)) %>%
select(uncchdid, ses_pc1, nsfnumb, gradeic)
# Combine all
combined_data1 <- left_join(raw_pheno_gest, icc_sex_data, by = c("uncchdid", "nsfnumb")) %>%
left_join(full_ses_anthro, by = c("uncchdid", "nsfnumb")) %>%
left_join(clock_data, by = c("uncchdid"))
combined_data1 <-left_join(combined_data1, BMI_values, by = c("uncchdid"))
# How many filtered out for gestation age?
combined_data1 %>%
filter(gestage > 308) %>% nrow()
# 10 longer than 308
#
combined_data1 %>%
filter(gestage < 224) %>% nrow()
# 5 shorter than 224 days
#
combined_data1 %>%
filter(is.na(gestage)) %>% nrow()
# 2 missing data for gestage (Do not infer these using the best_gestage variable)
combined_data1 %>%
filter(gestage > 308 | gestage < 224 | is.na(gestage)) %>% nrow()
# 17 missing in total
combined_data_ga_fixed <-combined_data1 %>%
filter(gestage <= 308 & gestage >= 224 & !is.na(gestage))
# Select relevant pieces
combined_data <- combined_data_ga_fixed %>%
select(uncchdid, blood_spot_date, iccsex, date_prg_term, date_icc_meas, icc_length_home, icc_weight_home, icc_armcircm_home, icc_abdom_mean_home, icc_tricep_mean_home, icc_bicep_mean_home, icc_subscap_mean_home, icc_supra_mean_home, icc_calf_mean_home, icc_thigh_mean_home, icc_headcirc_mean_home, gestage, prebmiz, dn_am_age, age_acceleration_diff, age_acceleration_residual, age, dn_am_age_hannum, bio_age4ha_static, dn_am_pheno_age, dn_am_age_skin_blood_clock, dn_am_adm, dn_am_b2m, dn_am_cystatin_c, dn_am_gdf15, dn_am_leptin, dn_am_packyrs, dn_am_pai1, dn_am_timp1, dn_am_grim_age, dn_am_tl, dn_am_age_hannum_adj_age, bio_age4ha_static_adj_age, dn_am_pheno_age_adj_age, dn_am_age_skin_blood_clock_adj_age, dn_am_adm_adj_age, dn_am_b2m_adj_age, dn_am_cystatin_c_adj_age, dn_am_gdf15adj_age, dn_am_leptin_adj_age, dn_am_packyrs_adj_age, dn_am_pai1adj_age, dn_am_timp1adj_age, dn_am_grim_age_adj_age, dn_am_tl_adj_age, ieaa, eeaa, ieaa_hannum, age_acceleration_residual_hannum, age_accel_pheno, age_accel_grim, ses_pc1, gradeic, smoke, max_preg_all) %>%
mutate(icc_total_skin_mean_home = icc_tricep_mean_home + icc_bicep_mean_home + icc_subscap_mean_home + icc_supra_mean_home + icc_calf_mean_home + icc_thigh_mean_home) %>%
mutate(measurement_age = date_icc_meas - date_prg_term) %>%
mutate(days_blood_preg = gestage - (date_prg_term - blood_spot_date)) %>% # CPR added
na.omit(uncchdid, iccsex, icc_weight_home, gestage, prebmiz, dn_am_age, age_acceleration_diff, age_acceleration_residual, age, dn_am_age_hannum, bio_age4ha_static, dn_am_pheno_age, dn_am_age_skin_blood_clock, dn_am_adm, dn_am_b2m, dn_am_cystatin_c, dn_am_gdf15, dn_am_leptin, dn_am_packyrs, dn_am_pai1, dn_am_timp1, dn_am_grim_age, dn_am_tl, dn_am_age_hannum_adj_age, bio_age4ha_static_adj_age, dn_am_pheno_age_adj_age, dn_am_age_skin_blood_clock_adj_age, dn_am_adm_adj_age, dn_am_b2m_adj_age, dn_am_cystatin_c_adj_age, dn_am_gdf15adj_age, dn_am_leptin_adj_age, dn_am_packyrs_adj_age, dn_am_pai1adj_age, dn_am_timp1adj_age, dn_am_grim_age_adj_age, dn_am_tl_adj_age, ieaa, eeaa, ieaa_hannum, age_acceleration_residual_hannum, age_accel_pheno, age_accel_grim, ses_pc1)
combined_data_ga_fixed %>% nrow()
# 334-17 = 317
# Check
# Quick check of who's getting thrown out.
`%nin%` <- function (x, y)
{
return(!(x %in% y))
}
# Show women not in combined_data (i.e. after removing ga anomalies)
combined_data_ga_fixed %>%
filter(uncchdid %nin% combined_data$uncchdid) %>% # Another 17.
select(-pregord_presnf, -hrshome, -notes) %>%
filter(uncchdid != "22814") %>%  ## 22814 did not pass quality control.
select_if(function(x) any(is.na(x))) %>%
visdat::vis_miss()
# 16 women still missing after removing ga anomalies and 22814 who did not pass QC.
# 14 of the remaining women are missing pre-bmi
combined_data_ga_fixed %>%
filter(is.na(prebmiz))
# The rest (2) others come from women missing all IC data
combined_data_ga_fixed %>%
filter(uncchdid %nin% combined_data$uncchdid) %>%
select(-pregord_presnf, -hrshome, -notes) %>%
filter(!is.na(prebmiz)) %>% # Filter to women NOT missing prebmiz
filter(uncchdid != "22814") %>%  ## 22814 did not pass quality control.
select_if(function(x) any(is.na(x))) %>%
visdat::vis_miss()
# 1 woman (22814) didn't pass epigenetic QC
# 14 women were missing prebmi
# 2 women were missing all (or nearly all such as skinfolds) icc data
combined_data %>%
filter(measurement_age > 14)
# 4 women not meausured within 14 days.
#
combined_data %>%
filter(is.na(days_blood_preg))
# 4 women not meausured within 14 days.
# 4 women not meausured within 14 days.
#
combined_data %>%
filter(days_blood_preg)
# 4 women not meausured within 14 days.
#
combined_data %>%
filter(is.na(days_blood_preg))
# Create new dataset
write_csv(combined_data, here::here("Data", "combined_final_data.csv"))
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
# Loading packages
library(tidyverse)
library(lubridate)
library(janitor)
library(skimr)
library(corrplot)
library(haven)
library(ggpubr)
library(sjlabelled)
library(sjPlot)
# Create new dataset
combined_data <- read_csv(here::here("Data/combined_final_data.csv")) #%>%
#filter(gestage <= 350)
1905 + 498 + 171 + 266 + 1798
670.67 + 550
1220.67 - 400
820.67 - 344.37
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
# Loading packages
library(tidyverse)
library(lubridate)
library(janitor)
library(skimr)
library(corrplot)
library(haven)
library(ggpubr)
library(sjlabelled)
library(sjPlot)
# Create new dataset
combined_data <- read_csv(here::here("Data/combined_final_data.csv"))
names(combined_data)
desc_table <-combined_data %>%
select(age, prebmiz, smoke, gradeic, ses_pc1, max_preg_all, measurement_age, days_blood_preg) %>%
tbl_summary(type = pregord_2005 ~ "continuous", statistic = list(all_continuous() ~ "{mean} ({min}, {max})"))
library(gtsummary)
desc_table <-combined_data %>%
select(age, prebmiz, smoke, gradeic, ses_pc1, max_preg_all, measurement_age, days_blood_preg) %>%
tbl_summary(type = pregord_2005 ~ "continuous", statistic = list(all_continuous() ~ "{mean} ({min}, {max})"))
desc_table <-combined_data %>%
select(age, prebmiz, smoke, gradeic, ses_pc1, max_preg_all, measurement_age, days_blood_preg) %>%
tbl_summary(statistic = list(all_continuous() ~ "{mean} ({min}, {max})"))
desc_table
# Loading packages
library(tidyverse)
library(lubridate)
library(janitor)
library(skimr)
library(corrplot)
library(haven)
library(ggpubr)
library(sjlabelled)
library(sjPlot)
# Read in datasets
raw_pheno_gest <- read_csv(file = here::here("Output/Data/raw_pheno_w_ga.csv")) %>%
clean_names() %>%
select(-iccsex) %>%
mutate(uncchdid = as_character(uncchdid)) %>%
rename(blood_spot_date = date)
icc_sex_data <- read_csv(file = here::here("Data/Phenotypic_Data/full_nsf_w_covariates.csv")) %>%
clean_names() %>%
filter(sample_type == "pregnancy") %>%
select(uncchdid, iccsex, nsfnumb) %>%
mutate(uncchdid = as_character(uncchdid))  # don't use double here
BMI_values <- read_dta(file = here::here("Data/Phenotypic_Data/For Ravi - pre BMI.dta")) %>%
clean_names() %>%
select(uncchdid, prebmiz) %>%
mutate(uncchdid = as_character(uncchdid)) %>%
na.omit() %>%  # And remove the NAs, because they always have at least one pre-preg BMI and one NA
unique() # Here I can remove duplicates, as they're redundant and the same for all pregnancies.
clock_data <- read_csv(file = here::here("Data/Clock_Data/cebu_long_w_baddetP_kept_in.output.csv")) %>%
clean_names() %>%
filter(str_detect(sample_id, "_p")) %>%
mutate(uncchdid = str_sub(sample_id, 2, 6)) %>% # because a few samples have _rep4 at the end, we need 2nd to 6th character, no 2nd to length -1
mutate(uncchdid = as_character(uncchdid))
full_ses_anthro <- read_csv(file = here::here("Data/Phenotypic_Data/full_ses_anthro.csv")) %>%
clean_names() %>%
arrange(uncchdid) %>%
mutate(uncchdid = as_character(uncchdid)) %>%
select(uncchdid, ses_pc1, nsfnumb, gradeic)
# Combine all
combined_data1 <- left_join(raw_pheno_gest, icc_sex_data, by = c("uncchdid", "nsfnumb")) %>%
left_join(full_ses_anthro, by = c("uncchdid", "nsfnumb")) %>%
left_join(clock_data, by = c("uncchdid"))
combined_data1 <-left_join(combined_data1, BMI_values, by = c("uncchdid"))
# How many filtered out for gestation age?
combined_data1 %>%
filter(gestage > 308) %>% nrow()
# 10 longer than 308
#
combined_data1 %>%
filter(gestage < 224) %>% nrow()
# 5 shorter than 224 days
#
combined_data1 %>%
filter(is.na(gestage)) %>% nrow()
# 2 missing data for gestage (Do not infer these using the best_gestage variable)
combined_data1 %>%
filter(gestage > 308 | gestage < 224 | is.na(gestage)) %>% nrow()
# 17 missing in total
combined_data_ga_fixed <-combined_data1 %>%
filter(gestage <= 308 & gestage >= 224 & !is.na(gestage))
# Select relevant pieces
combined_data <- combined_data_ga_fixed %>%
select(uncchdid, blood_spot_date, iccsex, date_prg_term, date_icc_meas, icc_length_home, icc_weight_home, icc_armcircm_home, icc_abdom_mean_home, icc_tricep_mean_home, icc_bicep_mean_home, icc_subscap_mean_home, icc_supra_mean_home, icc_calf_mean_home, icc_thigh_mean_home, icc_headcirc_mean_home, gestage, prebmiz, dn_am_age, age_acceleration_diff, age_acceleration_residual, age, dn_am_age_hannum, bio_age4ha_static, dn_am_pheno_age, dn_am_age_skin_blood_clock, dn_am_adm, dn_am_b2m, dn_am_cystatin_c, dn_am_gdf15, dn_am_leptin, dn_am_packyrs, dn_am_pai1, dn_am_timp1, dn_am_grim_age, dn_am_tl, dn_am_age_hannum_adj_age, bio_age4ha_static_adj_age, dn_am_pheno_age_adj_age, dn_am_age_skin_blood_clock_adj_age, dn_am_adm_adj_age, dn_am_b2m_adj_age, dn_am_cystatin_c_adj_age, dn_am_gdf15adj_age, dn_am_leptin_adj_age, dn_am_packyrs_adj_age, dn_am_pai1adj_age, dn_am_timp1adj_age, dn_am_grim_age_adj_age, dn_am_tl_adj_age, ieaa, eeaa, ieaa_hannum, age_acceleration_residual_hannum, age_accel_pheno, age_accel_grim, ses_pc1, gradeic, smoke, max_preg_all) %>%
mutate(icc_total_skin_mean_home = icc_tricep_mean_home + icc_bicep_mean_home + icc_subscap_mean_home + icc_supra_mean_home + icc_calf_mean_home + icc_thigh_mean_home) %>%
mutate(measurement_age = date_icc_meas - date_prg_term) %>%
mutate(days_blood_preg = gestage - (date_prg_term - blood_spot_date)) %>% # CPR added
na.omit(uncchdid, iccsex, icc_weight_home, gestage, prebmiz, dn_am_age, age_acceleration_diff, age_acceleration_residual, age, dn_am_age_hannum, bio_age4ha_static, dn_am_pheno_age, dn_am_age_skin_blood_clock, dn_am_adm, dn_am_b2m, dn_am_cystatin_c, dn_am_gdf15, dn_am_leptin, dn_am_packyrs, dn_am_pai1, dn_am_timp1, dn_am_grim_age, dn_am_tl, dn_am_age_hannum_adj_age, bio_age4ha_static_adj_age, dn_am_pheno_age_adj_age, dn_am_age_skin_blood_clock_adj_age, dn_am_adm_adj_age, dn_am_b2m_adj_age, dn_am_cystatin_c_adj_age, dn_am_gdf15adj_age, dn_am_leptin_adj_age, dn_am_packyrs_adj_age, dn_am_pai1adj_age, dn_am_timp1adj_age, dn_am_grim_age_adj_age, dn_am_tl_adj_age, ieaa, eeaa, ieaa_hannum, age_acceleration_residual_hannum, age_accel_pheno, age_accel_grim, ses_pc1)
combined_data_ga_fixed %>% nrow()
# Quick check of who's getting thrown out.
`%nin%` <- function (x, y)
{
return(!(x %in% y))
}
# Show women not in combined_data (i.e. after removing ga anomalies)
combined_data_ga_fixed %>%
filter(uncchdid %nin% combined_data$uncchdid) %>% # Another 17.
select(-pregord_presnf, -hrshome, -notes) %>%
filter(uncchdid != "22814") %>%  ## 22814 did not pass quality control.
select_if(function(x) any(is.na(x))) %>%
visdat::vis_miss()
combined_data_ga_fixed %>%
filter(uncchdid %nin% combined_data$uncchdid) %>% # Another 17.
select(-pregord_presnf, -hrshome, -notes) %>%
filter(uncchdid != "22814") %>%  ## 22814 did not pass quality control.
select_if(function(x) any(is.na(x)))
# 14 of the remaining women are missing pre-bmi
combined_data_ga_fixed %>%
filter(is.na(prebmiz))
# The rest (2) others come from women missing all IC data
combined_data_ga_fixed %>%
filter(uncchdid %nin% combined_data$uncchdid) %>%
select(-pregord_presnf, -hrshome, -notes) %>%
filter(!is.na(prebmiz)) %>% # Filter to women NOT missing prebmiz
filter(uncchdid != "22814") %>%  ## 22814 did not pass quality control.
select_if(function(x) any(is.na(x))) %>%
visdat::vis_miss()
combined_data %>%
filter(measurement_age > 14)
combined_data_ga_fixed %>%
filter(measurement_age > 14)
# Show women not in combined_data (i.e. after removing ga anomalies)
combined_datad %>%
filter(uncchdid %nin% combined_data$uncchdid) %>% # Another 17.
select(-pregord_presnf, -hrshome, -notes) %>%
filter(uncchdid != "22814") %>%  ## 22814 did not pass quality control.
select_if(function(x) any(is.na(x))) %>%
visdat::vis_miss()
# Show women not in combined_data (i.e. after removing ga anomalies)
combined_data %>%
filter(uncchdid %nin% combined_data$uncchdid) %>% # Another 17.
select(-pregord_presnf, -hrshome, -notes) %>%
filter(uncchdid != "22814") %>%  ## 22814 did not pass quality control.
select_if(function(x) any(is.na(x))) %>%
visdat::vis_miss()
combined_data %>% nrow()
combined_data_ga_fixed$uncchdid
combined_data_ga_fixed %>%
filter(uncchdid %nin% combined_data$uncchdid)
combined_data_ga_fixed %>%
filter(uncchdid %nin% combined_data$uncchdid) %>%
visdat::vis_miss()
combined_data_ga_fixed %>%
filter(uncchdid %nin% combined_data$uncchdid) %>%
select_if(function(x) any(is.na(x))) %>%
visdat::vis_miss()
combined_data_ga_fixed %>%
filter(uncchdid %nin% combined_data$uncchdid) %>% # Find the ones that are not in the reduced dataset
select(-contains("Probability")) %>%
select_if(function(x) any(is.na(x))) %>% # select any colums with missing values
visdat::vis_miss()
# Loading packages
library(tidyverse)
library(lubridate)
library(janitor)
library(skimr)
library(corrplot)
library(haven)
library(ggpubr)
library(sjlabelled)
library(sjPlot)
# Read in datasets
raw_pheno_gest <- read_csv(file = here::here("Output/Data/raw_pheno_w_ga.csv")) %>%
clean_names() %>%
select(-iccsex) %>%
mutate(uncchdid = as_character(uncchdid)) %>%
rename(blood_spot_date = date)
icc_sex_data <- read_csv(file = here::here("Data/Phenotypic_Data/full_nsf_w_covariates.csv")) %>%
clean_names() %>%
filter(sample_type == "pregnancy") %>%
select(uncchdid, iccsex, nsfnumb) %>%
mutate(uncchdid = as_character(uncchdid))  # don't use double here
BMI_values <- read_dta(file = here::here("Data/Phenotypic_Data/For Ravi - pre BMI.dta")) %>%
clean_names() %>%
select(uncchdid, prebmiz) %>%
mutate(uncchdid = as_character(uncchdid)) %>%
na.omit() %>%  # And remove the NAs, because they always have at least one pre-preg BMI and one NA
unique() # Here I can remove duplicates, as they're redundant and the same for all pregnancies.
clock_data <- read_csv(file = here::here("Data/Clock_Data/cebu_long_w_baddetP_kept_in.output.csv")) %>%
clean_names() %>%
filter(str_detect(sample_id, "_p")) %>%
mutate(uncchdid = str_sub(sample_id, 2, 6)) %>% # because a few samples have _rep4 at the end, we need 2nd to 6th character, no 2nd to length -1
mutate(uncchdid = as_character(uncchdid))
full_ses_anthro <- read_csv(file = here::here("Data/Phenotypic_Data/full_ses_anthro.csv")) %>%
clean_names() %>%
arrange(uncchdid) %>%
mutate(uncchdid = as_character(uncchdid)) %>%
select(uncchdid, ses_pc1, nsfnumb, gradeic)
# Combine all
combined_data1 <- left_join(raw_pheno_gest, icc_sex_data, by = c("uncchdid", "nsfnumb")) %>%
left_join(full_ses_anthro, by = c("uncchdid", "nsfnumb")) %>%
left_join(clock_data, by = c("uncchdid"))
combined_data1 <-left_join(combined_data1, BMI_values, by = c("uncchdid"))
# How many filtered out for gestation age?
combined_data1 %>%
filter(gestage > 308) %>% nrow()
# 10 longer than 308
#
combined_data1 %>%
filter(gestage < 224) %>% nrow()
# 5 shorter than 224 days
#
combined_data1 %>%
filter(is.na(gestage)) %>% nrow()
# 2 missing data for gestage (Do not infer these using the best_gestage variable)
combined_data1 %>%
filter(gestage > 308 | gestage < 224 | is.na(gestage)) %>% nrow()
# 17 missing in total
combined_data_ga_fixed <-combined_data1 %>%
filter(gestage <= 308 & gestage >= 224 & !is.na(gestage))
# Select relevant pieces
combined_data <- combined_data_ga_fixed %>%
select(uncchdid, blood_spot_date, iccsex, date_prg_term, date_icc_meas, icc_length_home, icc_weight_home, icc_armcircm_home, icc_abdom_mean_home, icc_tricep_mean_home, icc_bicep_mean_home, icc_subscap_mean_home, icc_supra_mean_home, icc_calf_mean_home, icc_thigh_mean_home, icc_headcirc_mean_home, gestage, prebmiz, dn_am_age, age_acceleration_diff, age_acceleration_residual, age, dn_am_age_hannum, bio_age4ha_static, dn_am_pheno_age, dn_am_age_skin_blood_clock, dn_am_adm, dn_am_b2m, dn_am_cystatin_c, dn_am_gdf15, dn_am_leptin, dn_am_packyrs, dn_am_pai1, dn_am_timp1, dn_am_grim_age, dn_am_tl, dn_am_age_hannum_adj_age, bio_age4ha_static_adj_age, dn_am_pheno_age_adj_age, dn_am_age_skin_blood_clock_adj_age, dn_am_adm_adj_age, dn_am_b2m_adj_age, dn_am_cystatin_c_adj_age, dn_am_gdf15adj_age, dn_am_leptin_adj_age, dn_am_packyrs_adj_age, dn_am_pai1adj_age, dn_am_timp1adj_age, dn_am_grim_age_adj_age, dn_am_tl_adj_age, ieaa, eeaa, ieaa_hannum, age_acceleration_residual_hannum, age_accel_pheno, age_accel_grim, ses_pc1, gradeic, smoke, max_preg_all) %>%
mutate(icc_total_skin_mean_home = icc_tricep_mean_home + icc_bicep_mean_home + icc_subscap_mean_home + icc_supra_mean_home + icc_calf_mean_home + icc_thigh_mean_home) %>%
mutate(measurement_age = date_icc_meas - date_prg_term) %>%
mutate(days_blood_preg = gestage - (date_prg_term - blood_spot_date)) %>% # CPR added
na.omit(uncchdid, iccsex, icc_weight_home, gestage, prebmiz, dn_am_age, age_acceleration_diff, age_acceleration_residual, age, dn_am_age_hannum, bio_age4ha_static, dn_am_pheno_age, dn_am_age_skin_blood_clock, dn_am_adm, dn_am_b2m, dn_am_cystatin_c, dn_am_gdf15, dn_am_leptin, dn_am_packyrs, dn_am_pai1, dn_am_timp1, dn_am_grim_age, dn_am_tl, dn_am_age_hannum_adj_age, bio_age4ha_static_adj_age, dn_am_pheno_age_adj_age, dn_am_age_skin_blood_clock_adj_age, dn_am_adm_adj_age, dn_am_b2m_adj_age, dn_am_cystatin_c_adj_age, dn_am_gdf15adj_age, dn_am_leptin_adj_age, dn_am_packyrs_adj_age, dn_am_pai1adj_age, dn_am_timp1adj_age, dn_am_grim_age_adj_age, dn_am_tl_adj_age, ieaa, eeaa, ieaa_hannum, age_acceleration_residual_hannum, age_accel_pheno, age_accel_grim, ses_pc1)
combined_data
combined_data %>% filter(measurement_age < 14)
# Just check measurement age now:
combined_data %>%
filter(measurement_age < 14) %>%
select(-contains("Probability")) %>%
select_if(function(x) any(is.na(x))) %>% # select any colums with missing values
visdat::vis_miss()
combined_data %>%
filter(measurement_age < 14) %>%
select(-contains("Probability"))
combined_data %>%
filter(measurement_age < 14) %>%
select(-contains("Probability")) %>%
select_if(function(x) any(is.na(x))) %>% # select any colums with missing values
visdat::vis_miss()
combined_data %>%
filter(measurement_age < 14) %>%
select(-contains("Probability")) %>%
select_if(function(x) any(is.na(x)))
# Just check measurement age now:
combined_data %>%
filter(measurement_age > 14) %>%
select(-contains("Probability")) %>%
select_if(function(x) any(is.na(x))) %>% # select any colums with missing values
visdat::vis_miss()
combined_data %>%
filter(measurement_age > 14) %>%
select(-contains("Probability")) %>%
select_if(function(x) any(is.na(x)))
combined_data %>%
filter(measurement_age > 14)
combined_data %>%
filter(measurement_age > 14) %>%
select(-contains("Probability"))
combined_data %>%
filter(measurement_age > 14) %>%
select(-contains("Probability")) %>%
select_if(function(x) any(is.na(x)))
# Just check measurement age now:
combined_data %>%
filter(measurement_age > 15) %>%
select(-contains("Probability")) %>%
select_if(function(x) any(is.na(x))) %>% # select any colums with missing values
visdat::vis_miss()
combined_data %>%
filter(measurement_age > 15) %>%
select(-contains("Probability")) %>%
select_if(function(x) any(is.na(x)))
combined_data %>%
filter(measurement_age > 15) %>%
select(-contains("Probability"))
# Just check measurement age now:
combined_data %>%
filter(measurement_age > 15) %>%
select(-contains("Probability"))
# Just check measurement age now:
combined_data %>%
filter(measurement_age < 15) %>%
select(-contains("Probability"))
# Just check measurement age now:
combined_data %>%
filter(measurement_age < 15)
# Create new dataset
write_csv(combined_data %>%
filter(measurement_age < 15), here::here("Data", "combined_final_data.csv"))
# Create new dataset
combined_data <- read_csv(here::here("Data/combined_final_data.csv"))
combined_data
desc_table <-combined_data %>%
select(age, prebmiz, smoke, gradeic, ses_pc1, max_preg_all, measurement_age, days_blood_preg) %>%
tbl_summary(statistic = list(all_continuous() ~ "{mean} ({min}, {max})"))
desc_table
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
ieaa_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + ieaa + days_blood_preg, data = combined_data)
eeaa_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + eeaa + days_blood_preg, data = combined_data)
phenoage_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + age_accel_pheno + days_blood_preg, data = combined_data)
grimage_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + age_accel_grim + days_blood_preg, data = combined_data)
adm_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_adm_adj_age + days_blood_preg, data = combined_data)
b2m_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_b2m_adj_age + days_blood_preg, data = combined_data)
cystatin_c_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_cystatin_c_adj_age + days_blood_preg, data = combined_data)
gdf15_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_gdf15adj_age + days_blood_preg, data = combined_data)
leptin_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_leptin_adj_age + days_blood_preg, data = combined_data)
pack_years_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_packyrs_adj_age + days_blood_preg, data = combined_data)
pai1_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_pai1adj_age + days_blood_preg, data = combined_data)
timp1_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_timp1adj_age + days_blood_preg, data = combined_data)
tl_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_tl_adj_age + days_blood_preg, data = combined_data)
sjPlot::tab_model(ieaa_gest_age_no_meas, eeaa_gest_age_no_meas, phenoage_gest_age_no_meas, grimage_gest_age_no_meas, adm_gest_age_no_meas, b2m_gest_age_no_meas, cystatin_c_gest_age_no_meas, gdf15_gest_age_no_meas, leptin_gest_age_no_meas, pack_years_gest_age_no_meas, pai1_gest_age_no_meas, timp1_gest_age_no_meas, tl_gest_age_no_meas, show.se = TRUE, show.stat = TRUE, show.std = TRUE)
desc_table_05 %>%
gtsummary::as_flex_table() %>%
flextable::save_as_docx(path = here::here("Output/Figures", "Table_1.docx"))
desc_table %>%
gtsummary::as_flex_table() %>%
flextable::save_as_docx(path = here::here("Output/Figures", "Table_1.docx"))
desc_table
names(combined_data)
desc_table <-combined_data %>%
select(iccsex, gestage, measurement_age, icc_length_home:icc_headcirc_mean_home) %>%
tbl_summary(statistic = list(all_continuous() ~ "{mean} ({min}, {max})"))
desc_table
desc_table %>%
gtsummary::as_flex_table() %>%
flextable::save_as_docx(path = here::here("Output/Figures", "Table_1_infants.docx"))
sjPlot::tab_model(ieaa_gest_age_no_meas, eeaa_gest_age_no_meas, phenoage_gest_age_no_meas, grimage_gest_age_no_meas, adm_gest_age_no_meas, b2m_gest_age_no_meas, cystatin_c_gest_age_no_meas, gdf15_gest_age_no_meas, leptin_gest_age_no_meas, pack_years_gest_age_no_meas, pai1_gest_age_no_meas, timp1_gest_age_no_meas, tl_gest_age_no_meas, show.est = FALSE, show.se = FALSE, show.stat = TRUE, show.std = TRUE)
sjPlot::tab_model(ieaa_meas_weight, eeaa_meas_weight, phenoage_meas_weight, grimage_meas_weight, adm_meas_weight, b2m_meas_weight, cystatin_c_meas_weight, gdf15_meas_weight, leptin_meas_weight, pack_years_meas_weight, pai1_meas_weight, timp1_meas_weight, tl_meas_weight, show.est = FALSE, show.se = FALSE, show.stat = TRUE, show.std = TRUE)
ieaa_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + ieaa + days_blood_preg, data = combined_data)
eeaa_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + eeaa + days_blood_preg, data = combined_data)
phenoage_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + age_accel_pheno + days_blood_preg, data = combined_data)
grimage_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + age_accel_grim + days_blood_preg, data = combined_data)
adm_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_adm_adj_age + days_blood_preg, data = combined_data)
b2m_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_b2m_adj_age + days_blood_preg, data = combined_data)
cystatin_c_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_cystatin_c_adj_age + days_blood_preg, data = combined_data)
gdf15_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_gdf15adj_age + days_blood_preg, data = combined_data)
leptin_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_leptin_adj_age + days_blood_preg, data = combined_data)
pack_years_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_packyrs_adj_age + days_blood_preg, data = combined_data)
pai1_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_pai1adj_age + days_blood_preg, data = combined_data)
timp1_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_timp1adj_age + days_blood_preg, data = combined_data)
tl_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_tl_adj_age + days_blood_preg, data = combined_data)
sjPlot::tab_model(ieaa_meas_weight, eeaa_meas_weight, phenoage_meas_weight, grimage_meas_weight, adm_meas_weight, b2m_meas_weight, cystatin_c_meas_weight, gdf15_meas_weight, leptin_meas_weight, pack_years_meas_weight, pai1_meas_weight, timp1_meas_weight, tl_meas_weight, show.est = FALSE, show.se = FALSE, show.stat = TRUE, show.std = TRUE)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
# Loading packages
library(tidyverse)
library(lubridate)
library(janitor)
library(skimr)
library(corrplot)
library(haven)
library(ggpubr)
library(sjlabelled)
library(sjPlot)
# Create new dataset
combined_data <- read_csv(here::here("Data/combined_final_data.csv")) #%>%
#filter(gestage <= 350)
ieaa_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + ieaa + days_blood_preg, data = combined_data)
eeaa_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + eeaa + days_blood_preg, data = combined_data)
phenoage_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + age_accel_pheno + days_blood_preg, data = combined_data)
grimage_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + age_accel_grim + days_blood_preg, data = combined_data)
adm_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_adm_adj_age + days_blood_preg, data = combined_data)
b2m_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_b2m_adj_age + days_blood_preg, data = combined_data)
cystatin_c_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_cystatin_c_adj_age + days_blood_preg, data = combined_data)
gdf15_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_gdf15adj_age + days_blood_preg, data = combined_data)
leptin_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_leptin_adj_age + days_blood_preg, data = combined_data)
pack_years_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_packyrs_adj_age + days_blood_preg, data = combined_data)
pai1_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_pai1adj_age + days_blood_preg, data = combined_data)
timp1_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_timp1adj_age + days_blood_preg, data = combined_data)
tl_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_tl_adj_age + days_blood_preg, data = combined_data)
sjPlot::tab_model(ieaa_gest_age_no_meas, eeaa_gest_age_no_meas, phenoage_gest_age_no_meas, grimage_gest_age_no_meas, adm_gest_age_no_meas, b2m_gest_age_no_meas, cystatin_c_gest_age_no_meas, gdf15_gest_age_no_meas, leptin_gest_age_no_meas, pack_years_gest_age_no_meas, pai1_gest_age_no_meas, timp1_gest_age_no_meas, tl_gest_age_no_meas, show.est = FALSE, show.se = FALSE, show.stat = TRUE, show.std = TRUE)
ieaa_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + ieaa + days_blood_preg, data = combined_data)
eeaa_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + eeaa + days_blood_preg, data = combined_data)
phenoage_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + age_accel_pheno + days_blood_preg, data = combined_data)
grimage_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + age_accel_grim + days_blood_preg, data = combined_data)
adm_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_adm_adj_age + days_blood_preg, data = combined_data)
b2m_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_b2m_adj_age + days_blood_preg, data = combined_data)
cystatin_c_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_cystatin_c_adj_age + days_blood_preg, data = combined_data)
gdf15_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_gdf15adj_age + days_blood_preg, data = combined_data)
leptin_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_leptin_adj_age + days_blood_preg, data = combined_data)
pack_years_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_packyrs_adj_age + days_blood_preg, data = combined_data)
pai1_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_pai1adj_age + days_blood_preg, data = combined_data)
timp1_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_timp1adj_age + days_blood_preg, data = combined_data)
tl_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_tl_adj_age + days_blood_preg, data = combined_data)
sjPlot::tab_model(ieaa_meas_weight, eeaa_meas_weight, phenoage_meas_weight, grimage_meas_weight, adm_meas_weight, b2m_meas_weight, cystatin_c_meas_weight, gdf15_meas_weight, leptin_meas_weight, pack_years_meas_weight, pai1_meas_weight, timp1_meas_weight, tl_meas_weight, show.est = FALSE, show.se = FALSE, show.stat = TRUE, show.std = TRUE)

<<<<<<< HEAD
geom_boxplot(alpha = 0.2)+
geom_jitter()
ga_file %>%
ggplot(., aes(x = durmonth, y = gestage_days, group = durmonth))+
geom_boxplot(alpha = 0.2)+
geom_jitter(0.1, alpha = 0.2)
ga_file %>%
ggplot(., aes(x = durmonth, y = gestage_days, group = durmonth))+
geom_boxplot(alpha = 0.2)+
geom_jitter(position = 0.1, alpha = 0.2)
ga_file %>%
ggplot(., aes(x = durmonth, y = gestage_days, group = durmonth))+
geom_boxplot(alpha = 0.2)+
geom_jitter(position = 1, alpha = 0.2)
ga_file %>%
ggplot(., aes(x = durmonth, y = gestage_days, group = durmonth))+
geom_boxplot(alpha = 0.2)+
geom_jitter(width = 0.1, alpha = 0.2)
# Early births
###############
ga_file %>%
filter(gestage < 269)
# Late Births
#############
ga_file %>%
filter(gestage > 308)
# Look at GA distributions
###############
ga_file %>%
ggplot(., aes(x = gestage))+
geom_histogram()
summary(ga_file$gestage)
mean(ga_file$gestage)
mean(ga_file$gestage, na.rm = T)
# Check
ga_file %>%
ggplot(., aes(x = gestage))+
geom_histogram()
# Check
ga_file %>%
ggplot(., aes(x = gestage))+
geom_histogram()+
geom_vline(xintercept = c(269, 308)) # based on the paper cited below
# good.
#
range(ga_file$gestage, na.rm = TRUE)
# What if I filter to only those with consistent pregord = pregord_all
ga_file %>%
filter(pregord_all == pregord) %>%
ggplot(., aes(x = gestage))+
geom_histogram()+
geom_vline(xintercept = c(269, 308))
ga_file %>%
filter(pregord_all == pregord)
# What if I filter to only those with consistent pregord = pregord_all
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(pregord_all == pregord) %>%
ggplot(., aes(x = gestage))+
geom_histogram()+
geom_vline(xintercept = c(269, 308))
# What if I filter to only those with consistent pregord = pregord_all
raw_pheno[raw_pheno$uncchdid == "23228", "lmpdate"] <-as_date("2010-02-15")
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(pregord_all == pregord) %>%
ggplot(., aes(x = gestage))+
geom_histogram()+
geom_vline(xintercept = c(269, 308))
# Check
ga_file %>%
ggplot(., aes(x = gestage))+
geom_histogram()+
geom_vline(xintercept = c(269, 308)) # based on the paper cited below
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(pregord_all == pregord) %>%
ggplot(., aes(x = gestage))+
geom_histogram()+
geom_vline(xintercept = c(269, 308))
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(pregord_all == pregord)
ga_file
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate)
raw_pheno$sample_type
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(pregord_all == pregord,
sample_type == "pregnancy") %>%
ggplot(., aes(x = gestage))+
geom_histogram()+
geom_vline(xintercept = c(269, 308))
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(pregord_all == pregord,
sample_type == "pregnancy")
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(sample_type == "pregnancy"))
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(sample_type == "pregnancy")
# Check using only pregnancy samples
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(sample_type == "pregnancy") %>%
nrow()
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(sample_type == "pregnancy") %>%
group_by(uncchdid) %>%
filter(n() > 1)
raw_pheno_w_ga <-raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(sample_type == "pregnancy")
raw_pheno_w_ga %>%
ggplot(., aes(x = bmi, y = gestage)) %>%
geom_point()
raw_pheno_w_ga %>%
ggplot(., aes(x = bmi, y = gestage)) +
geom_point()
raw_pheno_w_ga %>%
ggplot(., aes(x = numbpreg, y = gestage)) +
geom_point()
raw_pheno_w_ga %>%
ggplot(., aes(x = gestage, y = icc_weight_birth)) +
geom_point()
raw_pheno_w_ga %>%
ggplot(., aes(x = gestage, y = icc_weight_birth)) +
geom_point(alpha = 0.2)
raw_pheno_w_ga %>%
ggplot(., aes(x = gestage, y = icc_weight_birth, col = iccsex)) +
geom_point(alpha = 0.2)
raw_pheno_w_ga %>%
ggplot(., aes(x = gestage, y = icc_weight_birth, col = iccsex)) +
geom_point(alpha = 0.5)
raw_pheno_w_ga %>%
ggplot(., aes(x = gestage, y = icc_weight_birth, col = iccsex)) +
geom_point(alpha = 0.8)
raw_pheno_w_ga %>%
ggplot(., aes(x = gestage, y = icc_weight_birth, col = iccsex)) +
geom_point(alpha = 0.8)+
theme_bw
raw_pheno_w_ga %>%
ggplot(., aes(x = gestage, y = icc_weight_birth, col = iccsex)) +
geom_point(alpha = 0.8)+
theme_bw()
raw_pheno_w_ga %>%
select(date_icc_meas, date_prg_term)
raw_pheno_w_ga %>%
mutate(date_icc_meas-date_prg_term)
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home)) +
geom_point()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 14) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home)) +
geom_point()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home)) +
geom_point()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
facet_grid(~iccsex)
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 1)
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 1)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 5)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 2)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 3)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 6)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 4)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 7)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 8)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 9)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "div", palette = "spectrum")+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "div", palette = 1)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "div", palette = 5)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "seq", palette = 5)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "seq", palette = 2)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 2)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 3)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 4)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(alpha = 0.8)+
scale_color_brewer(type = "qual", palette = 5)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point()+
scale_color_brewer(type = "qual", palette = 5)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point()+
scale_color_brewer(type = "qual", palette = 1)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(size = 3)+
scale_color_brewer(type = "qual", palette = 1)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_weight_home, col = iccsex)) +
geom_point(size = 3)+
scale_color_brewer(type = "qual", palette = 1)+
facet_grid(~iccsex)+
theme_bw()
write_csv(raw_pheno_w_ga, here::here("Output/Data/Phenotypic_Data", "raw_pheno_w_ga.csv")
)
write_csv(raw_pheno_w_ga, here::here("Output/Data", "raw_pheno_w_ga.csv")
)
#Loading packages
=======
mutate(uncchdid = as.double(uncchdid))
full_ses_anthro <- read_csv(file = here::here("Data/Phenotypic_Data/full_ses_anthro.csv")) %>%
clean_names() %>%
arrange(uncchdid) %>%
filter(nsfnumb == 1) %>%
select(uncchdid, ses_pc1) %>%
unique()
# Combine all
combined_data <- left_join(BMI_values, icc_sex_data, by = c("uncchdid")) %>%
left_join(raw_pheno_gest, by = c("uncchdid")) %>%
left_join(clock_data, by = c("uncchdid")) %>%
left_join(full_ses_anthro, by = c("uncchdid")) %>%
unique()
# Select relevant pieces
combined_data <- combined_data %>%
select(uncchdid, blood_spot_date, iccsex, date_prg_term, date_icc_meas, icc_length_home, icc_weight_home, icc_armcircm_home, icc_abdom_mean_home, icc_tricep_mean_home, icc_bicep_mean_home, icc_subscap_mean_home, icc_supra_mean_home, icc_calf_mean_home, icc_thigh_mean_home, icc_headcirc_mean_home, gestage, prebmiz, dn_am_age, age_acceleration_diff, age_acceleration_residual, age, dn_am_age_hannum, bio_age4ha_static, dn_am_pheno_age, dn_am_age_skin_blood_clock, dn_am_adm, dn_am_b2m, dn_am_cystatin_c, dn_am_gdf15, dn_am_leptin, dn_am_packyrs, dn_am_pai1, dn_am_timp1, dn_am_grim_age, dn_am_tl, dn_am_age_hannum_adj_age, bio_age4ha_static_adj_age, dn_am_pheno_age_adj_age, dn_am_age_skin_blood_clock_adj_age, dn_am_adm_adj_age, dn_am_b2m_adj_age, dn_am_cystatin_c_adj_age, dn_am_gdf15adj_age, dn_am_leptin_adj_age, dn_am_packyrs_adj_age, dn_am_pai1adj_age, dn_am_timp1adj_age, dn_am_grim_age_adj_age, dn_am_tl_adj_age, ieaa, eeaa, ieaa_hannum, age_acceleration_residual_hannum, age_accel_pheno, age_accel_grim, ses_pc1) %>%
mutate(icc_total_skin_mean_home = icc_tricep_mean_home + icc_bicep_mean_home + icc_subscap_mean_home + icc_supra_mean_home + icc_calf_mean_home + icc_thigh_mean_home)
# Scatter plots of Ep Age vs. Weeks Preg
combined_data <- combined_data %>%
mutate(days_blood_preg = gestage - (date_prg_term - blood_spot_date)) %>%
mutate(days_blood_preg = as.double(days_blood_preg))
## Scatter plot with correlation coefficient
ggplot(data = combined_data, mapping = aes(x = days_blood_preg, y = ieaa)) +
geom_point() +
stat_cor(method = "pearson") +
geom_smooth(method='lm', formula= y~x)
ggplot(data = combined_data, mapping = aes(x = days_blood_preg, y = eeaa)) +
geom_point() +
stat_cor(method = "pearson") +
geom_smooth(method='lm', formula= y~x)
ggplot(data = combined_data, mapping = aes(x = days_blood_preg, y = age_accel_pheno)) +
geom_point() +
stat_cor(method = "pearson") +
geom_smooth(method='lm', formula= y~x)
ggplot(data = combined_data, mapping = aes(x = days_blood_preg, y = age_accel_grim)) +
geom_point() +
stat_cor(method = "pearson") +
geom_smooth(method='lm', formula= y~x)
ggplot(data = combined_data, mapping = aes(x = prebmiz, y = ieaa)) +
geom_point() +
stat_cor(method = "pearson") +
geom_smooth(method='lm', formula= y~x)
ggplot(data = combined_data, mapping = aes(x = prebmiz, y = eeaa)) +
geom_point() +
stat_cor(method = "pearson") +
geom_smooth(method='lm', formula= y~x)
ggplot(data = combined_data, mapping = aes(x = prebmiz, y = age_accel_pheno)) +
geom_point() +
stat_cor(method = "pearson") +
geom_smooth(method='lm', formula= y~x)
ggplot(data = combined_data, mapping = aes(x = prebmiz, y = age_accel_grim)) +
geom_point() +
stat_cor(method = "pearson") +
geom_smooth(method='lm', formula= y~x)
View(combined_data)
View(raw_pheno_gest)
# Select relevant pieces
combined_data <- combined_data %>%
select(uncchdid, blood_spot_date, iccsex, date_prg_term, date_icc_meas, icc_length_home, icc_weight_home, icc_armcircm_home, icc_abdom_mean_home, icc_tricep_mean_home, icc_bicep_mean_home, icc_subscap_mean_home, icc_supra_mean_home, icc_calf_mean_home, icc_thigh_mean_home, icc_headcirc_mean_home, gestage, prebmiz, dn_am_age, age_acceleration_diff, age_acceleration_residual, age, dn_am_age_hannum, bio_age4ha_static, dn_am_pheno_age, dn_am_age_skin_blood_clock, dn_am_adm, dn_am_b2m, dn_am_cystatin_c, dn_am_gdf15, dn_am_leptin, dn_am_packyrs, dn_am_pai1, dn_am_timp1, dn_am_grim_age, dn_am_tl, dn_am_age_hannum_adj_age, bio_age4ha_static_adj_age, dn_am_pheno_age_adj_age, dn_am_age_skin_blood_clock_adj_age, dn_am_adm_adj_age, dn_am_b2m_adj_age, dn_am_cystatin_c_adj_age, dn_am_gdf15adj_age, dn_am_leptin_adj_age, dn_am_packyrs_adj_age, dn_am_pai1adj_age, dn_am_timp1adj_age, dn_am_grim_age_adj_age, dn_am_tl_adj_age, ieaa, eeaa, ieaa_hannum, age_acceleration_residual_hannum, age_accel_pheno, age_accel_grim, ses_pc1) %>%
mutate(icc_total_skin_mean_home = icc_tricep_mean_home + icc_bicep_mean_home + icc_subscap_mean_home + icc_supra_mean_home + icc_calf_mean_home + icc_thigh_mean_home) %>%
mutate(measurement_age = as.double(date_icc_meas - date_prg_term))
## No Pre-BMI adjustments
ieaa_no_bmi <- lm(icc_weight_home ~ ieaa + gestage + measurement_age, data = combined_data)
View(ieaa_no_bmi)
## No Pre-BMI adjustments
ieaa_no_bmi <- lm(icc_weight_home ~ ieaa + gestage + measurement_age + iccsex, data = combined_data)
ieaa_no_bmi_icc_weight_home <- lm(icc_weight_home ~ ieaa + gestage + measurement_age + iccsex, data = combined_data)
ieaa_no_bmi_icc_length_home <- lm(icc_length_home ~ ieaa + gestage + measurement_age + iccsex, data = combined_data)
ieaa_no_bmi_icc_weight_home <- lm(icc_armcircm_home ~ ieaa + gestage + measurement_age + iccsex, data = combined_data)
ieaa_no_bmi_icc_weight_home <- lm(icc_abdom_mean_home ~ ieaa + gestage + measurement_age + iccsex, data = combined_data)
ieaa_no_bmi_icc_weight_home <- lm(icc_headcirc_mean_home ~ ieaa + gestage + measurement_age + iccsex, data = combined_data)
ieaa_no_bmi_icc_weight_home <- lm(icc_total_skin_mean_home ~ ieaa + gestage + measurement_age + iccsex, data = combined_data)
## No Pre-BMI adjustments
ieaa_no_bmi_icc_weight_home <- lm(icc_weight_home ~ ieaa + gestage + measurement_age + iccsex, data = combined_data)
ieaa_no_bmi_icc_length_home <- lm(icc_length_home ~ ieaa + gestage + measurement_age + iccsex, data = combined_data)
ieaa_no_bmi_icc_weight_home <- lm(icc_armcircm_home ~ ieaa + gestage + measurement_age + iccsex, data = combined_data)
ieaa_no_bmi_icc_weight_home <- lm(icc_abdom_mean_home ~ ieaa + gestage + measurement_age + iccsex, data = combined_data)
ieaa_no_bmi_icc_weight_home <- lm(icc_headcirc_mean_home ~ ieaa + gestage + measurement_age + iccsex, data = combined_data)
ieaa_no_bmi_icc_weight_home <- lm(icc_total_skin_mean_home ~ ieaa + gestage + measurement_age + iccsex, data = combined_data)
ieaa_no_bmi_icc_weight_home <- lm(icc_weight_home ~ ieaa + gestage + measurement_age + iccsex, data = combined_data)
ieaa_no_bmi_icc_length_home <- update(ieaa_no_bmi_icc_weight_home, icc_length_home ~ .)
ieaa_no_bmi_icc_armcircm_home <- update(ieaa_no_bmi_icc_weight_home, icc_armcircm_home ~ .)
ieaa_no_bmi_icc_abdom_mean_home <- update(ieaa_no_bmi_icc_weight_home, icc_abdom_mean_home ~ .)
ieaa_no_bmi_icc_headcirc_mean_home <- update(ieaa_no_bmi_icc_weight_home, icc_headcirc_mean_home ~ .)
ieaa_no_bmi_icc_total_skin_mean_home <- update(ieaa_no_bmi_icc_weight_home, icc_total_skin_mean_home ~ .)
eeaa_no_bmi_icc_weight_home <- lm(icc_weight_home ~ eeaa + gestage + measurement_age + iccsex, data = combined_data)
eeaa_no_bmi_icc_length_home <- update(eeaa_no_bmi_icc_weight_home, icc_length_home ~ .)
eeaa_no_bmi_icc_armcircm_home <- update(eeaa_no_bmi_icc_weight_home, icc_armcircm_home ~ .)
eeaa_no_bmi_icc_abdom_mean_home <- update(eeaa_no_bmi_icc_weight_home, icc_abdom_mean_home ~ .)
eeaa_no_bmi_icc_headcirc_mean_home <- update(eeaa_no_bmi_icc_weight_home, icc_headcirc_mean_home ~ .)
eeaa_no_bmi_icc_total_skin_mean_home <- update(eeaa_no_bmi_icc_weight_home, icc_total_skin_mean_home ~ .)
age_accel_grim_no_bmi_icc_weight_home <- lm(icc_weight_home ~ age_accel_grim + gestage + measurement_age + iccsex, data = combined_data)
age_accel_grim_no_bmi_icc_length_home <- update(age_accel_grim_no_bmi_icc_weight_home, icc_length_home ~ .)
age_accel_grim_no_bmi_icc_armcircm_home <- update(age_accel_grim_no_bmi_icc_weight_home, icc_armcircm_home ~ .)
age_accel_grim_no_bmi_icc_abdom_mean_home <- update(age_accel_grim_no_bmi_icc_weight_home, icc_abdom_mean_home ~ .)
age_accel_grim_no_bmi_icc_headcirc_mean_home <- update(age_accel_grim_no_bmi_icc_weight_home, icc_headcirc_mean_home ~ .)
age_accel_grim_no_bmi_icc_total_skin_mean_home <- update(age_accel_grim_no_bmi_icc_weight_home, icc_total_skin_mean_home ~ .)
sjPlot::tab_model(ieaa_no_bmi_icc_weight_home, ieaa_no_bmi_icc_length_home, ieaa_no_bmi_icc_armcircm_home, ieaa_no_bmi_icc_abdom_mean_home, ieaa_no_bmi_icc_headcirc_mean_home, ieaa_no_bmi_icc_total_skin_mean_home)
sjPlot::tab_model(eeaa_no_bmi_icc_weight_home, eeaa_no_bmi_icc_length_home, eeaa_no_bmi_icc_armcircm_home, eeaa_no_bmi_icc_abdom_mean_home, eeaa_no_bmi_icc_headcirc_mean_home, eeaa_no_bmi_icc_total_skin_mean_home)
sjPlot::tab_model(age_accel_pheno_no_bmi_icc_weight_home, age_accel_pheno_no_bmi_icc_length_home, age_accel_pheno_no_bmi_icc_armcircm_home, age_accel_pheno_no_bmi_icc_abdom_mean_home, age_accel_pheno_no_bmi_icc_headcirc_mean_home, age_accel_pheno_no_bmi_icc_total_skin_mean_home)
age_accel_pheno_no_bmi_icc_weight_home <- lm(icc_weight_home ~ age_accel_pheno + gestage + measurement_age + iccsex + ses_pc1, data = combined_data)
age_accel_pheno_no_bmi_icc_length_home <- update(age_accel_pheno_no_bmi_icc_weight_home, icc_length_home ~ .)
age_accel_pheno_no_bmi_icc_armcircm_home <- update(age_accel_pheno_no_bmi_icc_weight_home, icc_armcircm_home ~ .)
age_accel_pheno_no_bmi_icc_abdom_mean_home <- update(age_accel_pheno_no_bmi_icc_weight_home, icc_abdom_mean_home ~ .)
age_accel_pheno_no_bmi_icc_headcirc_mean_home <- update(age_accel_pheno_no_bmi_icc_weight_home, icc_headcirc_mean_home ~ .)
age_accel_pheno_no_bmi_icc_total_skin_mean_home <- update(age_accel_pheno_no_bmi_icc_weight_home, icc_total_skin_mean_home ~ .)
sjPlot::tab_model(age_accel_pheno_no_bmi_icc_weight_home, age_accel_pheno_no_bmi_icc_length_home, age_accel_pheno_no_bmi_icc_armcircm_home, age_accel_pheno_no_bmi_icc_abdom_mean_home, age_accel_pheno_no_bmi_icc_headcirc_mean_home, age_accel_pheno_no_bmi_icc_total_skin_mean_home)
sjPlot::tab_model(age_accel_grim_no_bmi_icc_weight_home, age_accel_grim_no_bmi_icc_length_home, age_accel_grim_no_bmi_icc_armcircm_home, age_accel_grim_no_bmi_icc_abdom_mean_home, age_accel_grim_no_bmi_icc_headcirc_mean_home, age_accel_grim_no_bmi_icc_total_skin_mean_home)
sjPlot::tab_model(ieaa_bmi_icc_weight_home, ieaa_bmi_icc_length_home, ieaa_bmi_icc_armcircm_home, ieaa_bmi_icc_abdom_mean_home, ieaa_bmi_icc_headcirc_mean_home, ieaa_bmi_icc_total_skin_mean_home)
ieaa_bmi_icc_weight_home <- lm(icc_weight_home ~ ieaa + gestage + measurement_age + iccsex + ses_pc1 + prebmiz, data = combined_data)
ieaa_bmi_icc_length_home <- update(ieaa_bmi_icc_weight_home, icc_length_home ~ .)
ieaa_bmi_icc_armcircm_home <- update(ieaa_bmi_icc_weight_home, icc_armcircm_home ~ .)
ieaa_bmi_icc_abdom_mean_home <- update(ieaa_bmi_icc_weight_home, icc_abdom_mean_home ~ .)
ieaa_bmi_icc_headcirc_mean_home <- update(ieaa_bmi_icc_weight_home, icc_headcirc_mean_home ~ .)
ieaa_bmi_icc_total_skin_mean_home <- update(ieaa_bmi_icc_weight_home, icc_total_skin_mean_home ~ .)
sjPlot::tab_model(ieaa_bmi_icc_weight_home, ieaa_bmi_icc_length_home, ieaa_bmi_icc_armcircm_home, ieaa_bmi_icc_abdom_mean_home, ieaa_bmi_icc_headcirc_mean_home, ieaa_bmi_icc_total_skin_mean_home)
eeaa_bmi_icc_weight_home <- lm(icc_weight_home ~ eeaa + gestage + measurement_age + iccsex + ses_pc1 + prebmiz, data = combined_data)
eeaa_bmi_icc_length_home <- update(eeaa_bmi_icc_weight_home, icc_length_home ~ .)
eeaa_bmi_icc_armcircm_home <- update(eeaa_bmi_icc_weight_home, icc_armcircm_home ~ .)
eeaa_bmi_icc_abdom_mean_home <- update(eeaa_bmi_icc_weight_home, icc_abdom_mean_home ~ .)
eeaa_bmi_icc_headcirc_mean_home <- update(eeaa_bmi_icc_weight_home, icc_headcirc_mean_home ~ .)
eeaa_bmi_icc_total_skin_mean_home <- update(eeaa_bmi_icc_weight_home, icc_total_skin_mean_home ~ .)
sjPlot::tab_model(eeaa_bmi_icc_weight_home, eeaa_bmi_icc_length_home, eeaa_bmi_icc_armcircm_home, eeaa_bmi_icc_abdom_mean_home, eeaa_bmi_icc_headcirc_mean_home, eeaa_bmi_icc_total_skin_mean_home)
age_accel_pheno_bmi_icc_weight_home <- lm(icc_weight_home ~ age_accel_pheno + gestage + measurement_age + iccsex + ses_pc1 + prebmiz, data = combined_data)
age_accel_pheno_bmi_icc_length_home <- update(age_accel_pheno_bmi_icc_weight_home, icc_length_home ~ .)
age_accel_pheno_bmi_icc_armcircm_home <- update(age_accel_pheno_bmi_icc_weight_home, icc_armcircm_home ~ .)
age_accel_pheno_bmi_icc_abdom_mean_home <- update(age_accel_pheno_bmi_icc_weight_home, icc_abdom_mean_home ~ .)
age_accel_pheno_bmi_icc_headcirc_mean_home <- update(age_accel_pheno_bmi_icc_weight_home, icc_headcirc_mean_home ~ .)
age_accel_pheno_bmi_icc_total_skin_mean_home <- update(age_accel_pheno_bmi_icc_weight_home, icc_total_skin_mean_home ~ .)
sjPlot::tab_model(age_accel_pheno_bmi_icc_weight_home, age_accel_pheno_bmi_icc_length_home, age_accel_pheno_bmi_icc_armcircm_home, age_accel_pheno_bmi_icc_abdom_mean_home, age_accel_pheno_bmi_icc_headcirc_mean_home, age_accel_pheno_bmi_icc_total_skin_mean_home)
age_accel_grim_bmi_icc_weight_home <- lm(icc_weight_home ~ age_accel_grim + gestage + measurement_age + iccsex + ses_pc1 + prebmiz, data = combined_data)
age_accel_grim_bmi_icc_length_home <- update(age_accel_grim_bmi_icc_weight_home, icc_length_home ~ .)
age_accel_grim_bmi_icc_armcircm_home <- update(age_accel_grim_bmi_icc_weight_home, icc_armcircm_home ~ .)
age_accel_grim_bmi_icc_abdom_mean_home <- update(age_accel_grim_bmi_icc_weight_home, icc_abdom_mean_home ~ .)
age_accel_grim_bmi_icc_headcirc_mean_home <- update(age_accel_grim_bmi_icc_weight_home, icc_headcirc_mean_home ~ .)
age_accel_grim_bmi_icc_total_skin_mean_home <- update(age_accel_grim_bmi_icc_weight_home, icc_total_skin_mean_home ~ .)
sjPlot::tab_model(age_accel_grim_bmi_icc_weight_home, age_accel_grim_bmi_icc_length_home, age_accel_grim_bmi_icc_armcircm_home, age_accel_grim_bmi_icc_abdom_mean_home, age_accel_grim_bmi_icc_headcirc_mean_home, age_accel_grim_bmi_icc_total_skin_mean_home)
View(clock_data)
# Create new dataset
write_csv(combined_data, here::here("Data", "combined_final_data.csv"))
# Loading packages
>>>>>>> 21cd0ac5281a667380f32a55b68da209b3396821
library(tidyverse)
library(lubridate)
library(janitor)
library(skimr)
library(corrplot)
library(haven)
<<<<<<< HEAD
# Load raw pheno
raw_pheno <- read_csv(file = here::here("Data/Phenotypic_Data/full_nsf_w_covariates.csv")) %>%
clean_names()
# Check for missing lmp or dur
raw_pheno %>% select(contains("lmp"))
# Not present.
# Load pregnancy data for dates and ids
currpreg_dates <- read_dta("Data/Phenotypic_Data/final NSF IC Female Pregnancy Tracking files/Pregnancy files/corrected Stata files/currpreg20141016.dta") %>%
select(uncchdid, nsfnumb, pregord, lmpdate, durmonth)
# Check for missing lmp or dur
dim(currpreg_dates)
currpreg_dates %>%
summary()
# Only missing 4 for lmp date...
currpreg_dates <- read_dta(file = here::here("Data/Phenotypic_Data/final NSF IC Female Pregnancy Tracking files/Pregnancy files/corrected Stata files/currpreg20141016.dta")) %>%
select(uncchdid, nsfnumb, pregord, lmpdate, durmonth, )
# Left join pregnancy dates to raw pheno
raw_pheno_new <-left_join(raw_pheno,
currpreg_dates,
by = c("uncchdid", "nsfnumb", "pregord_all" = "pregord"))
raw_pheno_new %>%
summary()
# Ok so I'm missing 125 for lmpdate, and 123 for durmonth.
# The issue may be arising where pregord_all and pregord are supposed to merge
# Join but remove pregord_all = pregord requirement (i.e. assume that my calculation of pregord all is right or pregord is, but not both)
raw_pheno <-left_join(raw_pheno,
currpreg_dates,
by = c("uncchdid", "nsfnumb"))
summary(raw_pheno)
# Only 2 NAs now.
# Now quickly check pregord_all/pregord
raw_pheno %>%
filter(pregord_all != pregord) %>%
gather(., key = pregord_type, value = number, c(pregord,pregord_all)) %>%
ggplot(., aes(pregord_type, number, group = uncchdid))+
geom_point(alpha = 0.2)+
geom_line(alpha = 0.1)
# Ok, pregord_all is higher for many than pregord. Also, pregord_all is meant to include any pregnancies that took place during the NSF survey. Use pregord_all.
# Build to be consistent with Chris's code (below)
####################################################
####################################################
# ** generating gestational age variable
# gen gestage = iccbirthdate-lmpdate
# gen gestagem = gestage/30
# ** there are 30 values above 301 (43 weeks) and some quite high.  Will infer an approx birth date
# ** based upon durmonth asked during preg interview and birth date.
# ** Will assume 30 day month and set each woman to middle of her reported month
# gen durmonthdays = 150+15 if durmonth==6
# replace durmonthdays = 180+15 if durmonth==7
# replace durmonthdays = 210+15 if durmonth==8
# replace durmonthdays = 240+15 if durmonth==9
# * generate date of pregnancy interview variable
# gen daypregmeas = mdy(monthmeas, daymeas, yearmeas)
# gen lmpinferred = daypregmeas-durmonthdays
# gen gestageinfer = iccbirthdate-lmpinferred
# gen bestgaicc = gestage
# replace bestgaicc = gestageinfer if gestage<0
# replace bestgaicc = gestageinfer if gestage==. & gestageinfer~=.
# replace bestgaicc = gestageinfer if gestage>301
####################################################
####################################################
# CPR:
# Create ga_file
###############
ga_file <-raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
select(uncchdid, lmpdate, date_preg_term, gestage, durmonth, outcome, date_preg_anthro)
# Look at GA distributions
###############
ga_file %>%
ggplot(., aes(x = gestage))+
geom_histogram()
# Ok, so one is -100 - makes no sense.
# Who is it?
ga_file %>%
filter(gestage <0)
# Ok, so clearly the year was just coded wrong.
# Fix the year of lmp for 23228
ga_file[ga_file$uncchdid == "23228", "lmpdate"] <- lubridate::as_date("2010-02-15")
# Recalculate gestage
ga_file <-ga_file %>%
mutate(gestage = date_preg_term - lmpdate)
mean(ga_file$gestage, na.rm = T)
# 276.7 days. Ok. That seems biased towards earlier
range(ga_file$gestage, na.rm = TRUE)
# That's a crazy difference, even after removing the year error above.
# Check
ga_file %>%
ggplot(., aes(x = gestage))+
geom_histogram()+
geom_vline(xintercept = c(269, 308)) # based on the paper cited below
# Yeah. Looks oddly left skewed.
# What if I filter to only those with consistent pregord = pregord_all
raw_pheno[raw_pheno$uncchdid == "23228", "lmpdate"] <- lubridate::as_date("2010-02-15")
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(pregord_all == pregord) %>%
ggplot(., aes(x = gestage))+
geom_histogram()+
geom_vline(xintercept = c(269, 308))
# Even including only those where pregord and pregord_all fit it looks left skewed. I take it these are the data.
# Check using only pregnancy samples
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(sample_type == "pregnancy") %>%
nrow()
# 334 - Do I have some duplicates?
raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(sample_type == "pregnancy") %>%
group_by(uncchdid) %>%
filter(n() > 1)
# Nope!
# A few checks...
raw_pheno_w_ga <-raw_pheno %>%
mutate(gestage = date_preg_term - lmpdate) %>%
filter(sample_type == "pregnancy")
raw_pheno_w_ga %>%
ggplot(., aes(x = gestage, y = icc_weight_birth, col = iccsex)) +
geom_point(alpha = 0.8)+
theme_bw()
raw_pheno_w_ga %>%
mutate(icc_age_at_meas = date_icc_meas-date_prg_term) %>%
filter(icc_age_at_meas < 21) %>%
ggplot(., aes(x = icc_age_at_meas, y = icc_length_home, col = iccsex)) +
geom_point(size = 3)+
scale_color_brewer(type = "qual", palette = 1)+
facet_grid(~iccsex)+
theme_bw()
raw_pheno_w_ga
# Ok looks decent.
#
raw_pheno_w_ga %>%
select(contains("smok"))
library(haven)
For_Ravi_pre_BMI <- read_dta("Data/Phenotypic_Data/For Ravi - pre BMI.dta")
View(For_Ravi_pre_BMI)
na.omit(For_Ravi_pre_BMI)
library(readr)
full_nsf_w_covariates <- read_csv("Data/Phenotypic_Data/full_nsf_w_covariates.csv")
View(full_nsf_w_covariates)
=======
library(ggpubr)
library(sjlabelled)
library(sjPlot)
# Read in datasets
raw_pheno_gest <- read_csv(file = here::here("Output/Data/raw_pheno_w_ga.csv")) %>%
clean_names() %>%
select(-iccsex) %>%
rename(blood_spot_date = date)
icc_sex_data <- read_csv(file = here::here("Data/Phenotypic_Data/full_nsf_w_covariates.csv")) %>%
clean_names() %>%
select(uncchdid, iccsex) %>%
mutate(uncchdid = as.double(uncchdid)) %>%
unique()
BMI_values <- read_dta(file = here::here("Data/Phenotypic_Data/For Ravi - pre BMI.dta")) %>%
clean_names() %>%
select(uncchdid, prebmiz) %>%
unique() %>%
na.omit()
clock_data <- read_csv(file = here::here("Data/Clock_Data/cebu_long_w_baddetP_kept_in.output.csv")) %>%
clean_names() %>%
filter(str_detect(sample_id, "_p")) %>%
mutate(uncchdid = str_sub(sample_id, 2, nchar(sample_id)-2)) %>%
mutate(uncchdid = as.double(uncchdid))
full_ses_anthro <- read_csv(file = here::here("Data/Phenotypic_Data/full_ses_anthro.csv")) %>%
clean_names() %>%
arrange(uncchdid) %>%
filter(nsfnumb == 1) %>%
select(uncchdid, ses_pc1) %>%
unique()
# Combine all
combined_data <- left_join(BMI_values, icc_sex_data, by = c("uncchdid")) %>%
left_join(raw_pheno_gest, by = c("uncchdid")) %>%
left_join(clock_data, by = c("uncchdid")) %>%
left_join(full_ses_anthro, by = c("uncchdid")) %>%
unique()
# Select relevant pieces
combined_data <- combined_data %>%
select(uncchdid, blood_spot_date, iccsex, date_prg_term, date_icc_meas, icc_length_home, icc_weight_home, icc_armcircm_home, icc_abdom_mean_home, icc_tricep_mean_home, icc_bicep_mean_home, icc_subscap_mean_home, icc_supra_mean_home, icc_calf_mean_home, icc_thigh_mean_home, icc_headcirc_mean_home, gestage, prebmiz, dn_am_age, age_acceleration_diff, age_acceleration_residual, age, dn_am_age_hannum, bio_age4ha_static, dn_am_pheno_age, dn_am_age_skin_blood_clock, dn_am_adm, dn_am_b2m, dn_am_cystatin_c, dn_am_gdf15, dn_am_leptin, dn_am_packyrs, dn_am_pai1, dn_am_timp1, dn_am_grim_age, dn_am_tl, dn_am_age_hannum_adj_age, bio_age4ha_static_adj_age, dn_am_pheno_age_adj_age, dn_am_age_skin_blood_clock_adj_age, dn_am_adm_adj_age, dn_am_b2m_adj_age, dn_am_cystatin_c_adj_age, dn_am_gdf15adj_age, dn_am_leptin_adj_age, dn_am_packyrs_adj_age, dn_am_pai1adj_age, dn_am_timp1adj_age, dn_am_grim_age_adj_age, dn_am_tl_adj_age, ieaa, eeaa, ieaa_hannum, age_acceleration_residual_hannum, age_accel_pheno, age_accel_grim, ses_pc1) %>%
mutate(icc_total_skin_mean_home = icc_tricep_mean_home + icc_bicep_mean_home + icc_subscap_mean_home + icc_supra_mean_home + icc_calf_mean_home + icc_thigh_mean_home) %>%
mutate(measurement_age = as.double(date_icc_meas - date_prg_term))
# Create new dataset
write_csv(combined_data, here::here("Data", "combined_final_data.csv"))
View(clock_data)
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
# Loading packages
library(tidyverse)
library(lubridate)
library(janitor)
library(skimr)
library(corrplot)
library(haven)
library(ggpubr)
library(sjlabelled)
library(sjPlot)
# Create new dataset
combined_data <- read_csv(here::here("Data/combined_final_data.csv"))
## Pre-BMI adjustments, grimage
age_accel_grim_bmi_icc_weight_home <- lm(icc_weight_home ~ age_accel_grim + gestage + measurement_age + iccsex + ses_pc1 + prebmiz, data = combined_data)
age_accel_grim_bmi_icc_length_home <- update(age_accel_grim_bmi_icc_weight_home, icc_length_home ~ .)
age_accel_grim_bmi_icc_armcircm_home <- update(age_accel_grim_bmi_icc_weight_home, icc_armcircm_home ~ .)
age_accel_grim_bmi_icc_abdom_mean_home <- update(age_accel_grim_bmi_icc_weight_home, icc_abdom_mean_home ~ .)
age_accel_grim_bmi_icc_headcirc_mean_home <- update(age_accel_grim_bmi_icc_weight_home, icc_headcirc_mean_home ~ .)
age_accel_grim_bmi_icc_total_skin_mean_home <- update(age_accel_grim_bmi_icc_weight_home, icc_total_skin_mean_home ~ .)
sjPlot::tab_model(age_accel_grim_bmi_icc_weight_home, age_accel_grim_bmi_icc_length_home, age_accel_grim_bmi_icc_armcircm_home, age_accel_grim_bmi_icc_abdom_mean_home, age_accel_grim_bmi_icc_headcirc_mean_home, age_accel_grim_bmi_icc_total_skin_mean_home)
## No Pre-BMI adjustments, dn_am_adm_adj_age
dn_am_adm_adj_age_no_bmi_icc_weight_home <- lm(icc_weight_home ~ dn_am_adm_adj_age + gestage + measurement_age + iccsex + ses_pc1, data = combined_data)
dn_am_adm_adj_age_no_bmi_icc_length_home <- update(dn_am_adm_adj_age_no_bmi_icc_weight_home, icc_length_home ~ .)
dn_am_adm_adj_age_no_bmi_icc_armcircm_home <- update(dn_am_adm_adj_age_no_bmi_icc_weight_home, icc_armcircm_home ~ .)
dn_am_adm_adj_age_no_bmi_icc_abdom_mean_home <- update(dn_am_adm_adj_age_no_bmi_icc_weight_home, icc_abdom_mean_home ~ .)
dn_am_adm_adj_age_no_bmi_icc_headcirc_mean_home <- update(dn_am_adm_adj_age_no_bmi_icc_weight_home, icc_headcirc_mean_home ~ .)
dn_am_adm_adj_age_no_bmi_icc_total_skin_mean_home <- update(dn_am_adm_adj_age_no_bmi_icc_weight_home, icc_total_skin_mean_home ~ .)
sjPlot::tab_model(dn_am_adm_adj_age_no_bmi_icc_weight_home, dn_am_adm_adj_age_no_bmi_icc_length_home, dn_am_adm_adj_age_no_bmi_icc_armcircm_home, dn_am_adm_adj_age_no_bmi_icc_abdom_mean_home, dn_am_adm_adj_age_no_bmi_icc_headcirc_mean_home, dn_am_adm_adj_age_no_bmi_icc_total_skin_mean_home)
## Pre-BMI adjustments, dn_am_adm_adj_age
dn_am_adm_adj_age_bmi_icc_weight_home <- lm(icc_weight_home ~ dn_am_adm_adj_age + gestage + measurement_age + iccsex + ses_pc1 + prebmiz, data = combined_data)
dn_am_adm_adj_age_bmi_icc_length_home <- update(dn_am_adm_adj_age_bmi_icc_weight_home, icc_length_home ~ .)
dn_am_adm_adj_age_bmi_icc_armcircm_home <- update(dn_am_adm_adj_age_bmi_icc_weight_home, icc_armcircm_home ~ .)
dn_am_adm_adj_age_bmi_icc_abdom_mean_home <- update(dn_am_adm_adj_age_bmi_icc_weight_home, icc_abdom_mean_home ~ .)
dn_am_adm_adj_age_bmi_icc_headcirc_mean_home <- update(dn_am_adm_adj_age_bmi_icc_weight_home, icc_headcirc_mean_home ~ .)
dn_am_adm_adj_age_bmi_icc_total_skin_mean_home <- update(dn_am_adm_adj_age_bmi_icc_weight_home, icc_total_skin_mean_home ~ .)
sjPlot::tab_model(dn_am_adm_adj_age_bmi_icc_weight_home, dn_am_adm_adj_age_bmi_icc_length_home, dn_am_adm_adj_age_bmi_icc_armcircm_home, dn_am_adm_adj_age_bmi_icc_abdom_mean_home, dn_am_adm_adj_age_bmi_icc_headcirc_mean_home, dn_am_adm_adj_age_bmi_icc_total_skin_mean_home)
par(mfrow = c(2,2))
plot(ieaa_no_bmi_icc_weight_home)
plot(ieaa_no_bmi_icc_weight_home, ieaa_no_bmi_icc_length_home)
2
2
par(mfrow = c(2,2))
plot(ieaa_no_bmi_icc_weight_home, ieaa_no_bmi_icc_length_home)
# Create new dataset
combined_data <- read_csv(here::here("Data/combined_final_data.csv"))
# Loading packages
library(tidyverse)
library(lubridate)
library(janitor)
library(skimr)
library(corrplot)
library(haven)
library(ggpubr)
library(sjlabelled)
library(sjPlot)
# Create new dataset
combined_data <- read_csv(here::here("Data/combined_final_data.csv"))
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
ieaa_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + ieaa, data = combined_data)
# Loading packages
library(tidyverse)
library(lubridate)
library(janitor)
library(skimr)
library(corrplot)
library(haven)
library(ggpubr)
library(sjlabelled)
library(sjPlot)
# Create new dataset
combined_data <- read_csv(here::here("Data/combined_final_data.csv"))
ieaa_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + ieaa, data = combined_data)
eeaa_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + eeaa, data = combined_data)
phenoage_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + age_accel_pheno, data = combined_data)
grimage_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + age_accel_grim, data = combined_data)
adm_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_adm_adj_age, data = combined_data)
b2m_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_b2m_adj_age, data = combined_data)
cystatin_c_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_cystatin_c_adj_age, data = combined_data)
gdf15_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_gdf15adj_age, data = combined_data)
leptin_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_leptin_adj_age, data = combined_data)
pack_years_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_packyrs_adj_age, data = combined_data)
pai1_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_pai1adj_age, data = combined_data)
timp1_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_timp1adj_age, data = combined_data)
tl_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_tl_adj_age, data = combined_data)
sjPlot::tab_model(ieaa_meas_weight, eeaa_meas_weight, phenoage_meas_weight, grimage_meas_weight, adm_meas_weight, b2m_meas_weight, cystatin_c_meas_weight, gdf15_meas_weight, leptin_meas_weight, pack_years_meas_weight, pai1_meas_weight, timp1_meas_weight, tl_meas_weight, show.se = TRUE, show.stat = TRUE)
ieaa_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + ieaa, data = combined_data)
eeaa_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + eeaa, data = combined_data)
phenoage_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + age_accel_pheno, data = combined_data)
grimage_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + age_accel_grim, data = combined_data)
adm_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_adm_adj_age, data = combined_data)
b2m_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_b2m_adj_age, data = combined_data)
cystatin_c_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_cystatin_c_adj_age, data = combined_data)
gdf15_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_gdf15adj_age, data = combined_data)
leptin_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_leptin_adj_age, data = combined_data)
pack_years_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_packyrs_adj_age, data = combined_data)
pai1_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_pai1adj_age, data = combined_data)
timp1_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_timp1adj_age, data = combined_data)
tl_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_tl_adj_age, data = combined_data)
sjPlot::tab_model(ieaa_meas_weight, eeaa_meas_weight, phenoage_meas_weight, grimage_meas_weight, adm_meas_weight, b2m_meas_weight, cystatin_c_meas_weight, gdf15_meas_weight, leptin_meas_weight, pack_years_meas_weight, pai1_meas_weight, timp1_meas_weight, tl_meas_weight, show.se = TRUE, show.stat = TRUE, show.std = TRUE)
ggplot(data = combined_data) +
geom_point(mapping = aes(x = age_accel_grim, y = gestage))
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
# Loading packages
library(tidyverse)
library(lubridate)
library(janitor)
library(skimr)
library(corrplot)
library(haven)
library(ggpubr)
library(sjlabelled)
library(sjPlot)
# Create new dataset
combined_data <- read_csv(here::here("Data/combined_final_data.csv")) %>%
filter(gestage <= 350)
ieaa_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + ieaa, data = combined_data)
eeaa_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + eeaa, data = combined_data)
phenoage_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + age_accel_pheno, data = combined_data)
grimage_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + age_accel_grim, data = combined_data)
adm_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_adm_adj_age, data = combined_data)
b2m_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_b2m_adj_age, data = combined_data)
cystatin_c_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_cystatin_c_adj_age, data = combined_data)
gdf15_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_gdf15adj_age, data = combined_data)
leptin_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_leptin_adj_age, data = combined_data)
pack_years_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_packyrs_adj_age, data = combined_data)
pai1_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_pai1adj_age, data = combined_data)
timp1_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_timp1adj_age, data = combined_data)
tl_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_tl_adj_age, data = combined_data)
sjPlot::tab_model(ieaa_gest_age_no_meas, eeaa_gest_age_no_meas, phenoage_gest_age_no_meas, grimage_gest_age_no_meas, adm_gest_age_no_meas, b2m_gest_age_no_meas, cystatin_c_gest_age_no_meas, gdf15_gest_age_no_meas, leptin_gest_age_no_meas, pack_years_gest_age_no_meas, pai1_gest_age_no_meas, timp1_gest_age_no_meas, tl_gest_age_no_meas, show.se = TRUE, show.stat = TRUE, show.std = TRUE)
# Loading packages
library(tidyverse)
library(lubridate)
library(janitor)
library(skimr)
library(corrplot)
library(haven)
library(ggpubr)
library(sjlabelled)
library(sjPlot)
# Create new dataset
combined_data <- read_csv(here::here("Data/combined_final_data.csv")) #%>%
#filter(gestage <= 350)
# Loading packages
library(tidyverse)
library(lubridate)
library(janitor)
library(skimr)
library(corrplot)
library(haven)
library(ggpubr)
library(sjlabelled)
library(sjPlot)
# Create new dataset
combined_data <- read_csv(here::here("Data/combined_final_data.csv")) #%>%
#filter(gestage <= 350)
# Loading packages
library(tidyverse)
library(lubridate)
library(janitor)
library(skimr)
library(corrplot)
library(haven)
library(ggpubr)
library(sjlabelled)
library(sjPlot)
# Read in datasets
raw_pheno_gest <- read_csv(file = here::here("Output/Data/raw_pheno_w_ga.csv")) %>%
clean_names() %>%
select(-iccsex) %>%
rename(blood_spot_date = date)
icc_sex_data <- read_csv(file = here::here("Data/Phenotypic_Data/full_nsf_w_covariates.csv")) %>%
clean_names() %>%
select(uncchdid, iccsex) %>%
mutate(uncchdid = as.double(uncchdid)) %>%
unique()
BMI_values <- read_dta(file = here::here("Data/Phenotypic_Data/For Ravi - pre BMI.dta")) %>%
clean_names() %>%
select(uncchdid, prebmiz) %>%
unique() %>%
na.omit()
clock_data <- read_csv(file = here::here("Data/Clock_Data/cebu_long_w_baddetP_kept_in.output.csv")) %>%
clean_names() %>%
filter(str_detect(sample_id, "_p")) %>%
mutate(uncchdid = str_sub(sample_id, 2, nchar(sample_id)-2)) %>%
mutate(uncchdid = as.double(uncchdid))
full_ses_anthro <- read_csv(file = here::here("Data/Phenotypic_Data/full_ses_anthro.csv")) %>%
clean_names() %>%
arrange(uncchdid) %>%
filter(nsfnumb == 1) %>%
select(uncchdid, ses_pc1) %>%
unique()
# Combine all
combined_data <- left_join(BMI_values, icc_sex_data, by = c("uncchdid")) %>%
left_join(raw_pheno_gest, by = c("uncchdid")) %>%
left_join(clock_data, by = c("uncchdid")) %>%
left_join(full_ses_anthro, by = c("uncchdid")) %>%
unique()
# Select relevant pieces
combined_data <- combined_data %>%
select(uncchdid, blood_spot_date, iccsex, date_prg_term, date_icc_meas, icc_length_home, icc_weight_home, icc_armcircm_home, icc_abdom_mean_home, icc_tricep_mean_home, icc_bicep_mean_home, icc_subscap_mean_home, icc_supra_mean_home, icc_calf_mean_home, icc_thigh_mean_home, icc_headcirc_mean_home, gestage, prebmiz, dn_am_age, age_acceleration_diff, age_acceleration_residual, age, dn_am_age_hannum, bio_age4ha_static, dn_am_pheno_age, dn_am_age_skin_blood_clock, dn_am_adm, dn_am_b2m, dn_am_cystatin_c, dn_am_gdf15, dn_am_leptin, dn_am_packyrs, dn_am_pai1, dn_am_timp1, dn_am_grim_age, dn_am_tl, dn_am_age_hannum_adj_age, bio_age4ha_static_adj_age, dn_am_pheno_age_adj_age, dn_am_age_skin_blood_clock_adj_age, dn_am_adm_adj_age, dn_am_b2m_adj_age, dn_am_cystatin_c_adj_age, dn_am_gdf15adj_age, dn_am_leptin_adj_age, dn_am_packyrs_adj_age, dn_am_pai1adj_age, dn_am_timp1adj_age, dn_am_grim_age_adj_age, dn_am_tl_adj_age, ieaa, eeaa, ieaa_hannum, age_acceleration_residual_hannum, age_accel_pheno, age_accel_grim, ses_pc1) %>%
mutate(icc_total_skin_mean_home = icc_tricep_mean_home + icc_bicep_mean_home + icc_subscap_mean_home + icc_supra_mean_home + icc_calf_mean_home + icc_thigh_mean_home) %>%
mutate(measurement_age = as.double(date_icc_meas - date_prg_term))
# Create new dataset
write_csv(combined_data, here::here("Data", "combined_final_data.csv"))
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
# Loading packages
library(tidyverse)
library(lubridate)
library(janitor)
library(skimr)
library(corrplot)
library(haven)
library(ggpubr)
library(sjlabelled)
library(sjPlot)
# Create new dataset
combined_data <- read_csv(here::here("Data/combined_final_data.csv")) #%>%
#filter(gestage <= 350)
ieaa_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + ieaa, data = combined_data)
eeaa_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + eeaa, data = combined_data)
phenoage_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + age_accel_pheno, data = combined_data)
grimage_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + age_accel_grim, data = combined_data)
adm_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_adm_adj_age, data = combined_data)
b2m_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_b2m_adj_age, data = combined_data)
cystatin_c_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_cystatin_c_adj_age, data = combined_data)
gdf15_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_gdf15adj_age, data = combined_data)
leptin_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_leptin_adj_age, data = combined_data)
pack_years_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_packyrs_adj_age, data = combined_data)
pai1_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_pai1adj_age, data = combined_data)
timp1_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_timp1adj_age, data = combined_data)
tl_gest_age_no_meas <- lm(gestage ~ iccsex + ses_pc1 + prebmiz + dn_am_tl_adj_age, data = combined_data)
sjPlot::tab_model(ieaa_gest_age_no_meas, eeaa_gest_age_no_meas, phenoage_gest_age_no_meas, grimage_gest_age_no_meas, adm_gest_age_no_meas, b2m_gest_age_no_meas, cystatin_c_gest_age_no_meas, gdf15_gest_age_no_meas, leptin_gest_age_no_meas, pack_years_gest_age_no_meas, pai1_gest_age_no_meas, timp1_gest_age_no_meas, tl_gest_age_no_meas, show.se = TRUE, show.stat = TRUE, show.std = TRUE)
ieaa_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + ieaa, data = combined_data)
eeaa_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + eeaa, data = combined_data)
phenoage_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + age_accel_pheno, data = combined_data)
grimage_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + age_accel_grim, data = combined_data)
adm_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_adm_adj_age, data = combined_data)
b2m_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_b2m_adj_age, data = combined_data)
cystatin_c_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_cystatin_c_adj_age, data = combined_data)
gdf15_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_gdf15adj_age, data = combined_data)
leptin_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_leptin_adj_age, data = combined_data)
pack_years_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_packyrs_adj_age, data = combined_data)
pai1_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_pai1adj_age, data = combined_data)
timp1_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_timp1adj_age, data = combined_data)
tl_meas_weight <- lm(icc_weight_home ~ measurement_age + iccsex + ses_pc1 + prebmiz + dn_am_tl_adj_age, data = combined_data)
sjPlot::tab_model(ieaa_meas_weight, eeaa_meas_weight, phenoage_meas_weight, grimage_meas_weight, adm_meas_weight, b2m_meas_weight, cystatin_c_meas_weight, gdf15_meas_weight, leptin_meas_weight, pack_years_meas_weight, pai1_meas_weight, timp1_meas_weight, tl_meas_weight, show.se = TRUE, show.stat = TRUE, show.std = TRUE)
ggplot(data = combined_data) +
geom_point(mapping = aes(x = age_accel_grim, y = gestage)) +
geom_smooth()
ggplot(data = combined_data) +
geom_point(mapping = aes(x = age_accel_grim, y = gestage)) +
geom_smooth(mapping = aes(x = age_accel_grim, y = gestage))
ggplot(data = combined_data) +
geom_point(mapping = aes(x = age_accel_grim, y = gestage)) +
geom_abline(grimage_gest_age_no_meas)
ggplot(data = combined_data) +
geom_point(mapping = aes(x = age_accel_grim, y = gestage)) +
geom_abline(grimage_gest_age_no_meas, mapping = aes(x = age_accel_grim, y = gestage))
ggplot(data = combined_data, mapping = aes(x = age_accel_grim, y = gestage)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
ggplot(data = combined_data, mapping = aes(x = age_accel_grim, y = gestage)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "black")
ggplot(data = combined_data, mapping = aes(x = age_accel_grim, y = gestage)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "black") +
labs(x = "GrimAgeAccel", y = "Gestational Age (days)")
ggplot(data = combined_data, mapping = aes(x = age_accel_grim, y = gestage)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "black") +
labs(x = "GrimAgeAccel", y = "Gestational Age (days)")
ggplot(data = combined_data, mapping = aes(x = dn_am_pai1adj_age, y = gestage)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "black") +
labs(x = "Age Adjusted DNAm PAI-1", y = "Gestational Age (days)")
ggplot(data = combined_data, mapping = aes(x = dn_am_adm_adj_age, y = gestage)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "black") +
labs(x = "Age Adjusted DNAm ADM", y = "Gestational Age (days)")
ggplot(data = combined_data, mapping = aes(x = dn_am_cystatin_c_adj_age, y = gestage)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "black") +
labs(x = "Age Adjusted DNAm Cystatin C", y = "Gestational Age (days)")
ggplot(data = combined_data, mapping = aes(x = age_accel_grim, y = icc_weight_home)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "black") +
labs(x = "GrimAgeAccel", y = "Measured Weight (g)")
ggplot(data = combined_data, mapping = aes(x = dn_am_pai1adj_age, y = icc_weight_home)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "black") +
labs(x = "Age Adjusted DNAm PAI-1", y = "Measured Weight (g)")
ggplot(data = combined_data, mapping = aes(x = dn_am_adm_adj_age, y = icc_weight_home)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "black") +
labs(x = "Age Adjusted DNAm ADM", y = "Measured Weight (g)")
ggplot(data = combined_data, mapping = aes(x = dn_am_cystatin_c_adj_age, y = icc_weight_home)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "black") +
labs(x = "Age Adjusted DNAm Cystatin C", y = "Measured Weight (g)")
ggplot(data = combined_data, mapping = aes(x = age_accel_grim, y = gestage)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "black") +
labs(x = "GrimAgeAccel", y = "Gestational Age (days)")
ggplot(data = combined_data, mapping = aes(x = dn_am_pai1adj_age, y = gestage)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "black") +
labs(x = "Age Adjusted DNAm PAI-1", y = "Gestational Age (days)")
ggplot(data = combined_data, mapping = aes(x = dn_am_adm_adj_age, y = gestage)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "black") +
labs(x = "Age Adjusted DNAm ADM", y = "Gestational Age (days)")
ggplot(data = combined_data, mapping = aes(x = dn_am_cystatin_c_adj_age, y = gestage)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "black") +
labs(x = "Age Adjusted DNAm Cystatin C", y = "Gestational Age (days)")
# Adding the Leptin figure because it was significant
ggplot(data = combined_data, mapping = aes(x = dn_am_leptin_adj_age, y = gestage)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "black") +
labs(x = "Age Adjusted DNAm Leptin", y = "Gestational Age (days)")
>>>>>>> 21cd0ac5281a667380f32a55b68da209b3396821
